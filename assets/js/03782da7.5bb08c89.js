"use strict";(self.webpackChunkacd=self.webpackChunkacd||[]).push([[8115],{3515:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>p,frontMatter:()=>d,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"ros2/cmakelists","title":"CMakeLists.txt in ROS2","description":"In ROS2, CMakeLists.txt plays a pivotal role in defining the build configuration of your package. It is a CMake script used by the ament build system to compile and link your code, manage dependencies, and define installation rules. A well-configured CMakeLists.txt ensures smooth development and deployment of your ROS2 package.","source":"@site/docs/ros2/08_cmakelists.md","sourceDirName":"ros2","slug":"/ros2/cmakelists","permalink":"/Autonomous-Connected-Driving/docs/ros2/cmakelists","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ros2/08_cmakelists.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{},"sidebar":"ros2Sidebar","previous":{"title":"Understanding ROS 2 Packages","permalink":"/Autonomous-Connected-Driving/docs/ros2/package"},"next":{"title":"How to Start ROS2 Nodes","permalink":"/Autonomous-Connected-Driving/docs/ros2/start_ros2_nodes"}}');var t=s(4848),a=s(8453);const d={},c="CMakeLists.txt in ROS2",r={},l=[{value:"Basics of <code>CMakeLists.txt</code>",id:"basics-of-cmakeliststxt",level:2},{value:"Step-by-Step Configuration",id:"step-by-step-configuration",level:2},{value:"1. Setting Up the Project",id:"1-setting-up-the-project",level:3},{value:"2. Finding Dependencies",id:"2-finding-dependencies",level:3},{value:"3. Adding Targets",id:"3-adding-targets",level:3},{value:"4. Installing Targets",id:"4-installing-targets",level:3},{value:"5. Exporting Dependencies",id:"5-exporting-dependencies",level:3},{value:"6. Optional: Adding Tests",id:"6-optional-adding-tests",level:3},{value:"Full Example",id:"full-example",level:2},{value:"Advanced Topics",id:"advanced-topics",level:2},{value:"1. Custom Build Options",id:"1-custom-build-options",level:3},{value:"2. Using Python Nodes",id:"2-using-python-nodes",level:3},{value:"3. Generating Messages and Services",id:"3-generating-messages-and-services",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Common Errors and Debugging",id:"common-errors-and-debugging",level:2},{value:"Conclusion",id:"conclusion",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"cmakeliststxt-in-ros2",children:"CMakeLists.txt in ROS2"})}),"\n",(0,t.jsxs)(n.p,{children:["In ROS2, ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," plays a pivotal role in defining the build configuration of your package. It is a CMake script used by the ",(0,t.jsx)(n.code,{children:"ament"})," build system to compile and link your code, manage dependencies, and define installation rules. A well-configured ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," ensures smooth development and deployment of your ROS2 package."]}),"\n",(0,t.jsxs)(n.p,{children:["This documentation provides an in-depth guide to understanding, creating, and configuring ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," for ROS2, catering to both beginners and advanced users."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"basics-of-cmakeliststxt",children:["Basics of ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Purpose:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Specify the minimum CMake version."}),"\n",(0,t.jsx)(n.li,{children:"Declare the package name and dependencies."}),"\n",(0,t.jsx)(n.li,{children:"Define targets (e.g., executables, libraries)."}),"\n",(0,t.jsx)(n.li,{children:"Configure installation paths."}),"\n",(0,t.jsx)(n.li,{children:"Set up testing and documentation generation."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Structure:\nA typical ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," file consists of the following sections:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Project setup."}),"\n",(0,t.jsx)(n.li,{children:"Dependencies and packages."}),"\n",(0,t.jsx)(n.li,{children:"Build targets."}),"\n",(0,t.jsx)(n.li,{children:"Installation instructions."}),"\n",(0,t.jsx)(n.li,{children:"Testing configurations (optional)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"step-by-step-configuration",children:"Step-by-Step Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"1-setting-up-the-project",children:"1. Setting Up the Project"}),"\n",(0,t.jsx)(n.p,{children:"Start by specifying the minimum required CMake version and project name:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"cmake_minimum_required(VERSION 3.5)\nproject(my_ros2_package)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-finding-dependencies",children:"2. Finding Dependencies"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"find_package"})," to locate dependencies. For example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"find_package(ament_cmake REQUIRED)\nfind_package(rclcpp REQUIRED)\nfind_package(sensor_msgs REQUIRED)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-adding-targets",children:"3. Adding Targets"}),"\n",(0,t.jsx)(n.p,{children:"Define targets such as executables or libraries."}),"\n",(0,t.jsx)(n.p,{children:"For an executable:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"add_executable(my_node src/my_node.cpp)\nament_target_dependencies(my_node rclcpp sensor_msgs)\n"})}),"\n",(0,t.jsx)(n.p,{children:"For a library:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"add_library(my_library src/my_library.cpp)\nament_target_dependencies(my_library rclcpp)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-installing-targets",children:"4. Installing Targets"}),"\n",(0,t.jsx)(n.p,{children:"Specify installation rules to ensure the built binaries are placed in the appropriate location:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"install(TARGETS my_node\n  DESTINATION lib/${PROJECT_NAME})\n"})}),"\n",(0,t.jsx)(n.h3,{id:"5-exporting-dependencies",children:"5. Exporting Dependencies"}),"\n",(0,t.jsx)(n.p,{children:"Export dependencies so that other packages using this package can link against them:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"ament_export_dependencies(rclcpp sensor_msgs)\nament_package()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"6-optional-adding-tests",children:"6. Optional: Adding Tests"}),"\n",(0,t.jsxs)(n.p,{children:["Configure tests using ",(0,t.jsx)(n.code,{children:"ament_add_gtest"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"ament_add_gtest(test_my_node test/test_my_node.cpp)\nif(TARGET test_my_node)\n  target_link_libraries(test_my_node my_library)\nendif()\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"full-example",children:"Full Example"}),"\n",(0,t.jsxs)(n.p,{children:["Below is a complete example of ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," for a simple ROS2 package:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"cmake_minimum_required(VERSION 3.5)\nproject(my_ros2_package)\n\n# Find dependencies\nfind_package(ament_cmake REQUIRED)\nfind_package(rclcpp REQUIRED)\nfind_package(sensor_msgs REQUIRED)\n\n# Add executable\nadd_executable(my_node src/my_node.cpp)\nament_target_dependencies(my_node rclcpp sensor_msgs)\n\n# Install executable\ninstall(TARGETS my_node\n  DESTINATION lib/${PROJECT_NAME})\n\n# Export dependencies\nament_export_dependencies(rclcpp sensor_msgs)\nament_package()\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"advanced-topics",children:"Advanced Topics"}),"\n",(0,t.jsx)(n.h3,{id:"1-custom-build-options",children:"1. Custom Build Options"}),"\n",(0,t.jsx)(n.p,{children:"Add custom options to enable or disable features at build time:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:'option(USE_SIMULATION "Enable simulation mode" ON)\nif(USE_SIMULATION)\n  add_definitions(-DUSE_SIMULATION)\nendif()\n'})}),"\n",(0,t.jsx)(n.h3,{id:"2-using-python-nodes",children:"2. Using Python Nodes"}),"\n",(0,t.jsx)(n.p,{children:"For Python-based nodes, include:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:"ament_python_install_package(${PROJECT_NAME})\ninstall(PROGRAMS scripts/my_python_node.py\n  DESTINATION lib/${PROJECT_NAME})\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-generating-messages-and-services",children:"3. Generating Messages and Services"}),"\n",(0,t.jsx)(n.p,{children:"To include custom message or service files:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cmake",children:'find_package(rosidl_default_generators REQUIRED)\nrosidl_generate_interfaces(${PROJECT_NAME}\n  "msg/MyMessage.msg"\n  "srv/MyService.srv"\n)\nament_export_dependencies(rosidl_default_runtime)\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Consistency: Follow a consistent structure for all ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," files in your project."]}),"\n",(0,t.jsx)(n.li,{children:"Comments: Add comments to explain each section, especially for complex configurations."}),"\n",(0,t.jsxs)(n.li,{children:["Validation: Regularly test your ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," by building the package from scratch."]}),"\n",(0,t.jsxs)(n.li,{children:["Avoid Hardcoding: Use variables like ",(0,t.jsx)(n.code,{children:"${PROJECT_NAME}"})," and ",(0,t.jsx)(n.code,{children:"${CMAKE_INSTALL_PREFIX}"})," to avoid hardcoding paths."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"common-errors-and-debugging",children:"Common Errors and Debugging"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Missing Dependencies:\nEnsure all required dependencies are included using ",(0,t.jsx)(n.code,{children:"find_package"})," and ",(0,t.jsx)(n.code,{children:"ament_target_dependencies"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Incorrect Install Paths:\nVerify the ",(0,t.jsx)(n.code,{children:"install"})," directives and ensure they match the expected directory structure."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Unresolved Symbols:\nCheck if all linked libraries and exported dependencies are correctly configured."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," file is the backbone of your ROS2 package build process. A well-structured and optimized file not only simplifies development but also ensures compatibility and scalability. By following this guide, you can create robust ",(0,t.jsx)(n.code,{children:"CMakeLists.txt"})," configurations tailored to your project needs."]}),"\n",(0,t.jsxs)(n.p,{children:["For further details, refer to the ",(0,t.jsx)(n.a,{href:"https://docs.ros.org/en/rolling/index.html",children:"ROS2 Documentation"})," and the ",(0,t.jsx)(n.a,{href:"https://cmake.org/documentation/",children:"CMake Documentation"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>c});var i=s(6540);const t={},a=i.createContext(t);function d(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);