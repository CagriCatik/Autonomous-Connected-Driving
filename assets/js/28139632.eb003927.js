"use strict";(self.webpackChunkacd=self.webpackChunkacd||[]).push([[5643],{7019:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>t,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"task/intro/ROS-Bags","title":"ROS Bags","description":"ROS1","source":"@site/docs/task/01_intro/05_ROS-Bags.md","sourceDirName":"task/01_intro","slug":"/task/intro/ROS-Bags","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS-Bags","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/task/01_intro/05_ROS-Bags.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"taskSidebar","previous":{"title":"ROS Nodes in C++","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS-Nodes-in-Cpp"},"next":{"title":"ROS Application","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS-Application"}}');var i=n(4848),o=n(8453);const r={},t="ROS Bags",l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"ROS bag command line tool",id:"ros-bag-command-line-tool",level:2},{value:"Rosbag record",id:"rosbag-record",level:3},{value:"Rosbag info",id:"rosbag-info",level:3},{value:"Rosbag play",id:"rosbag-play",level:3},{value:"RQT bag GUI",id:"rqt-bag-gui",level:2},{value:"CARLA Application: Combination of ROS Bag, RViz, ROS Launch",id:"carla-application-combination-of-ros-bag-rviz-ros-launch",level:2},{value:"Wrap-up",id:"wrap-up",level:2}];function h(e){const a={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.header,{children:(0,i.jsx)(a.h1,{id:"ros-bags",children:"ROS Bags"})}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{src:"https://img.shields.io/badge/ROS1-blue",alt:"ROS1"})}),"\n",(0,i.jsx)(a.p,{children:"This subsection shows how to record and play back data from ROS topics such that you can store them."}),"\n",(0,i.jsx)(a.p,{children:"In this exercise you will learn"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"how to use rosbag record to save data from ROS topics"}),"\n",(0,i.jsx)(a.li,{children:"to analysis rosbags with rosbag info and the rqt logging feature"}),"\n",(0,i.jsx)(a.li,{children:"how to play back data from a robag with to hands-on examples"}),"\n"]}),"\n",(0,i.jsx)(a.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(a.p,{children:["Start multiple terminals in an ",(0,i.jsx)(a.code,{children:"acdc"})," docker container and start:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"roscore\n"})}),"\n",(0,i.jsx)(a.h2,{id:"ros-bag-command-line-tool",children:"ROS bag command line tool"}),"\n",(0,i.jsxs)(a.p,{children:["From official ROS documentation: A ",(0,i.jsx)(a.a,{href:"https://wiki.ros.org/Bags",children:"bag"})," is a file format in ROS for storing ROS message data. Bags - so named because of their ",(0,i.jsx)(a.code,{children:".bag"})," extension - have an important role in ROS, and a variety of tools have been written to allow you to store, process, analyze, and visualize them."]}),"\n",(0,i.jsxs)(a.p,{children:["The command line tool for dealing with bags is ",(0,i.jsx)(a.a,{href:"https://wiki.ros.org/rosbag",children:"rosbag"}),". Check out its functionalities:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"rosbag\n"})}),"\n",(0,i.jsxs)(a.p,{children:["We will use rosbag ",(0,i.jsx)(a.code,{children:"record"}),", ",(0,i.jsx)(a.code,{children:"info"}),", and ",(0,i.jsx)(a.code,{children:"play"}),"."]}),"\n",(0,i.jsx)(a.h3,{id:"rosbag-record",children:"Rosbag record"}),"\n",(0,i.jsxs)(a.p,{children:["In the following, we will record all messages from the ",(0,i.jsx)(a.code,{children:"/vehicle/actuator_commands"})," topic. Therefore, first start the flatland simulation:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"roslaunch racing flatland_simulation.launch\n"})}),"\n",(0,i.jsxs)(a.p,{children:["In another terminal, find out how to use ",(0,i.jsx)(a.code,{children:"rosbag record"}),":"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"rosbag record --help\n"})}),"\n",(0,i.jsxs)(a.p,{children:["We see that the command expects topic names to be recorded as arguments. Besides that, there are many useful options which are not important now. ",(0,i.jsx)(a.code,{children:"rosbag record"})," stores the recorded ",(0,i.jsx)(a.code,{children:".bag"})," file in the current directory of the terminal in which it is executed. Therefore, navigate into the racing package:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"roscd racing\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Record all messages that are published to the ",(0,i.jsx)(a.code,{children:"/vehicle/actuator_commands"})," topic from now on:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"rosbag record /vehicle/actuator_commands\n"})}),"\n",(0,i.jsx)(a.p,{children:"So far, nobody publishes to this topic yet. Therefore, open a new terminal window and execute the vehicle controller so actual messages are available for recording:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"roslaunch racing racing_controller.launch\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Once the cart is stuck, stop the recording by hitting ",(0,i.jsx)("kbd",{children:"Ctrl"}),"+",(0,i.jsx)("kbd",{children:"C"}),' in the "rosbag record" terminal. Also terminate the controller and the flatland simulation for now.']}),"\n",(0,i.jsx)(a.h3,{id:"rosbag-info",children:"Rosbag info"}),"\n",(0,i.jsxs)(a.p,{children:['In your "rosbag record" terminal, you can now see the recorded ',(0,i.jsx)(a.code,{children:".bag"})," file with a time stamp in its name:"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{children:"ls\n"})}),"\n",(0,i.jsxs)(a.p,{children:["In a real-world project, bag files usually become too large (multiple GB) for tracking them inside a git repository. Therefore, the ",(0,i.jsx)(a.code,{children:"*.bag"})," extension has been added to the so-called ",(0,i.jsx)(a.code,{children:".gitignore"}),' file of this branch. This means that even though you now have a new file in your git repository, its status is still "clean":']}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"git status\n"})}),"\n",(0,i.jsx)(a.p,{children:"Now, we analyze the newly recorded file:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"rosbag info 20<<< HIT TAB FOR AUTO-COMPLETION >>>\n"})}),"\n",(0,i.jsxs)(a.p,{children:['Useful information are especially "topics" and "types". Note that "duration" is probably shorter than the time span during which ',(0,i.jsx)(a.code,{children:"rosbag record"})," was just running because the initial interval without available messages has been automatically truncated."]}),"\n",(0,i.jsx)(a.h3,{id:"rosbag-play",children:"Rosbag play"}),"\n",(0,i.jsx)(a.p,{children:"We will now steer the cart from the bag file without a running controller node. Therefore, start the simulation again:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"roslaunch racing flatland_simulation.launch\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Find out how to use ",(0,i.jsx)(a.code,{children:"rosbag play"}),":"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"rosbag play --help\n"})}),"\n",(0,i.jsx)(a.p,{children:"It expects the bag file name (or path) as an argument and accepts a number of further options. Make sure you are in the recorded bag file's directory and execute:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"rosbag play -l 20<<< HIT TAB FOR AUTO-COMPLETION >>>\n"})}),"\n",(0,i.jsxs)(a.p,{children:["The ",(0,i.jsx)(a.code,{children:"-l"}),' option means "loop", so we have the messages available for more than just a few seconds. You should see the cart moving just like before. Pause and resume the playback using ',(0,i.jsx)("kbd",{children:"Space"}),"."]}),"\n",(0,i.jsx)(a.h2,{id:"rqt-bag-gui",children:"RQT bag GUI"}),"\n",(0,i.jsxs)(a.p,{children:["You can record, analyze, and play back bag files also in the rqt plugin ",(0,i.jsx)(a.a,{href:"https://wiki.ros.org/rqt_bag",children:"rqt_bag"}),"."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"rqt\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Select ",(0,i.jsx)(a.em,{children:"Plugins --\x3e Logging --\x3e Bag"}),". If there are other open plugins from a config you may have used before, close them, e.g. using ",(0,i.jsx)(a.em,{children:"Running --\x3e Close [...]"}),"."]}),"\n",(0,i.jsxs)(a.p,{children:["Use ",(0,i.jsx)(a.img,{alt:"openBag",src:n(2497).A+"",width:"28",height:"24"})," to open the bag file you have just recorded, which brings something like this:"]}),"\n",(0,i.jsx)("img",{src:"../images/rqt_bag_start.PNG",alt:"Description of image"}),"\n",(0,i.jsxs)(a.p,{children:["Similar to ",(0,i.jsx)(a.code,{children:"rosbag play"}),', you can right-click on the topic name and check "publish". Only then, the play symbol ',(0,i.jsx)(a.img,{alt:"play_symbol",src:n(7942).A+"",width:"28",height:"24"})," will actually publish this recorded topic."]}),"\n",(0,i.jsxs)(a.p,{children:["If you only want to analyze the bag file ",(0,i.jsx)(a.em,{children:"within"})," ",(0,i.jsx)(a.code,{children:"rqt_bag"}),', you can unselect the "Publish" option and instead:']}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.em,{children:"Right-click the topic name --\x3e View --\x3e Raw"}),' (similar to "Topic Monitor")']}),"\n",(0,i.jsxs)(a.li,{children:[(0,i.jsx)(a.em,{children:"Right-click the topic name --\x3e View --\x3e Plot"}),' (similar to "Plot")']}),"\n"]}),"\n",(0,i.jsxs)(a.p,{children:["The main advantage of these ",(0,i.jsx)(a.code,{children:"rqt_bag"})," plugins over the similar general rqt plugins is the possibility to easily stop and go forward or back in time."]}),"\n",(0,i.jsxs)(a.p,{children:["Select ",(0,i.jsx)(a.code,{children:"linear.x"})," for plotting and play back the file:"]}),"\n",(0,i.jsx)("img",{src:"../images/rqt_bag_with_plugins.png",alt:"Description of image"}),"\n",(0,i.jsx)(a.h2,{id:"carla-application-combination-of-ros-bag-rviz-ros-launch",children:"CARLA Application: Combination of ROS Bag, RViz, ROS Launch"}),"\n",(0,i.jsxs)(a.p,{children:["In a last step, we observe the provided bag file ",(0,i.jsx)(a.code,{children:"carla.bag"}),", which was recorded within the ",(0,i.jsx)(a.a,{href:"https://github.com/carla-simulator",children:"CARLA simulator environment"}),". CARLA is a well known, widely used, open-source simulation software, based on Unreal Engine. It comes with a built in ",(0,i.jsx)(a.a,{href:"https://github.com/carla-simulator/ros-bridge",children:"ROS bridge"}),", allowing the usage and visualization within ROS. In this Unit, we will visualize some simulation results, contained in the provided ",(0,i.jsx)(a.code,{children:"carla.bag"})," file."]}),"\n",(0,i.jsxs)(a.p,{children:["Download the bag file from the Sciebo project folder and save the file to the local directory ",(0,i.jsx)(a.code,{children:"${REPOSITORY}/bag"})," on your host."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"wget -O ${REPOSITORY}/bag/carla.bag https://rwth-aachen.sciebo.de/s/LJoX6lL8gdvO2e2/download\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Alternatively, you can download the bag file for this Unit here ",(0,i.jsx)(a.a,{href:"https://rwth-aachen.sciebo.de/s/LJoX6lL8gdvO2e2",children:(0,i.jsx)(a.strong,{children:"Link"})})," (approx. 700 MB). (In case you have not done yet)"]}),"\n",(0,i.jsxs)(a.p,{children:["We can use the provided launch file ",(0,i.jsx)(a.code,{children:"carla.launch"})," in the ",(0,i.jsx)(a.code,{children:"workshops/section_1/carla/"})," folder to play the ",(0,i.jsx)(a.code,{children:"rosbag"})," together with the provided ",(0,i.jsx)(a.code,{children:"carla_ad_demo.rviz"})," configuration in Rviz."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"cd src/workshops/section_1/carla\nroslaunch carla.launch\n"})}),"\n",(0,i.jsxs)(a.p,{children:["Note: Using ",(0,i.jsx)(a.code,{children:"roslaunch"})," is possible outside of a defined ROS package, but we have to launch it from the corresponding folder."]}),"\n",(0,i.jsxs)(a.p,{children:["The launch file replays all recorded topics from the bag file and visualizes them inside of RViz.\n",(0,i.jsx)(a.img,{alt:"ezgif.com-gif-maker",src:n(130).A+"",width:"597",height:"336"})]}),"\n",(0,i.jsx)(a.p,{children:"We can observe the different sensor data which are captured for the simulated scene in CARLA. Within ROS, we could use those sensor topics for further data processing."}),"\n",(0,i.jsx)(a.h2,{id:"wrap-up",children:"Wrap-up"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsxs)(a.li,{children:["You learned to use the ",(0,i.jsx)(a.code,{children:"rosbag"})," command to record, analyze, or play data within rosbags"]}),"\n",(0,i.jsx)(a.li,{children:"You learned how to analyze rosbag data in more detail with rqt"}),"\n"]})]})}function d(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},130:(e,a,n)=>{n.d(a,{A:()=>s});const s=n.p+"assets/images/ezgif.com-gif-maker-ea6e64d559131e056534da72f6159e77.gif"},2497:(e,a,n)=>{n.d(a,{A:()=>s});const s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAYCAYAAADpnJ2CAAAABHNCSVQICAgIfAhkiAAAAAFzUkdCAK7OHOkAAAAEZ0FNQQAAsY8L/GEFAAAACXBIWXMAABJ0AAASdAHeZh94AAAAGXRFWHRTb2Z0d2FyZQBnbm9tZS1zY3JlZW5zaG907wO/PgAAA1JJREFUSEu9VktPE1EYPTNICImlQSA+VgoGjSYmlGA0cSEbwJ0JQdCFP8MfYggxrDUhGA3qQkA0mgAqFOJCy8NSwPIQ6Bvoazozft+dGWing7IAz+TMfcy953z3m9u5laJb67o/EMD29g7CoRCOA1XV1XC7XKitvQBp8uuYLkkyGhqvm4+PB9PeCUjQIW8nttHgaQJ0/VjpaWxCIpGAHA6Hqa3/F7KX9LzvmX63/R4tmiJxwPj4Z0iSZLYMpNNplJeXo66uDjU11WbvvyBh4EU/ZKNRHI3X68XAwCsoigKPx1PAUGgL9fX1WFjww+fzFc11orUgw5A7bFxZWUV7ezsZZqFpWgEjkTCtrAY3btwk8xBGRt6L4EZHxxy19kgQhs4RURIolVkyVFW1gIyenm709j5BMBhEKp1CR0eHeEcckJMek/FXQwan1G7Y1fVAsLPzPm43N8PlOmmOdtayyDiEYfEK85nL5QQtOGlZZJwQd26YHXZc2fmO+MsJQKNJRC7FWNGmKqXwvKph9tsbXFZyWJp7h7KqMzj38JGpUAhhmB+BHWXJOM7eagZKjNh4e9sheugmNIiLT/sP1DNTum9q0YJO0fPK0kvTBpeniFxyexKpwBek/GNIzn9Cau4jkrMfkA1tFulZkoahw2VBV8iQNo6WSkLdTUCNR5CLbSEX+Q0lvA5lawXZjSVk1xeRWQ8gu+ZHciWYp7R/MfYNbRFZUGIR6PEo1NUAtKAfanAe6vIMcks+qL/moHH/xir08CYQ5bEJ6JlMkR5fDGFIPcUU/RqlbAY6rUJfXYS+sQb6pUOKxemrv0tMQt5JQ94lcrmTEqWuOOiZmnuG9oiMbqpTSqW0ghISKiHBkj1xk7uGiVHnMgWN37tdj0kwUmp7KAYweOvnyDCjFAga5sT8lZl1iUnn60Ga4rRobbsjPkn5mPBO0SuJ4vTrx5A4lTyJI1dpIpF3Lretej5cV6/hUnef2TIgyzKGBt+ahq1tRYaMSCSCaCwmPm+HQWlpKU5VVqKSaIcwHBo0DFtaWh0NjxJsODw8BJmjYTM+GZzyfhRkbfZgL9ldUQHfzA/aH2QqS0T5iElmpM0Htdvthvib+NO/IP7gRKNRMwFHC14Zm12sq8UfzyYYInv8m90AAAAASUVORK5CYII="},7942:(e,a,n)=>{n.d(a,{A:()=>s});const s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAYCAYAAADpnJ2CAAAABHNCSVQICAgIfAhkiAAAAAFzUkdCAK7OHOkAAAAEZ0FNQQAAsY8L/GEFAAAACXBIWXMAABJ0AAASdAHeZh94AAAAGXRFWHRTb2Z0d2FyZQBnbm9tZS1zY3JlZW5zaG907wO/PgAAArFJREFUSEu9lktME1EUhv8ZlEAUSiMqJphIwfjARB4pGjeuSFjoQkxcIMQYE+oLYnTl0pC4cNGCLkyMCu40gi7VjTtD1dKWqC3G0gSiwYTWYktKZ6ad8dzpwxJvC9XWf/o1nZk757vnzqQZIbS4oPn8fkQiywgGAihFttTWwlBVBZOpAcL7t280QRDR2t6ROl2aOB3vIECDGAlH0NpmBjStpLS1mxEOhyEGg0Ha1/4LzCWydmkORKm3ZHShruPM6MaTUxiftHLPFUqyrbSQHeAw89WNqOJAj3UPJiZt3DEFQUkuKe3wYOlq74TVchUJeNFj24txu407dj2wrClMqFFE5RkcaW6EzXINqvAZp4f3YcI+zL0mHyxrCmUlhpgURTjqx4/laZh378Stc1cQ17zoHdlfkJgl7z1kkUgoKYpOTF7BEokDETdam+px88wAZBL33W7GM/sIv0Y2lHV1KMvKKiTqeGnZh8WfTrQ07MBQ7yA9XC703TmAl+5Rbi0GS0rIl7LElBXqTs6LHI/RQ6Xq4xNqgluLPnqSwhwbi0TLmF7SNEpcwwZxKyrKd2HKN4+hx/dQKR7E2KVpdLWczaqwemP5LfxjRqkOSZheyriioQw1KC+rg2v2G6zPn2LTxhaMXnSj+9Agt0aGbCEd4UOJyVFasjj9qoQoVmN6bgF3X7yCsfIwRi+4cLJjgH8tD0pGyJsViyRJ0NQKfJwP4NFrO7ZvPoqH553o7rjMvSYX9KXXSz00OQZRPsx9p/9TD+prOvHAMoUT5sJE2bDkFTbWNcO07Rju9zv+SZQmI6Q9LtePj6GbRLxzfwUlb4fFRhcajUaoqgpBoDcOzqBiwGozB3OJhupqeLyfoGokFQVCLDIko9oejwcGgwH6a+IX36z+ghMKhfS2ix3WGZM1NZrwCzzmE5k1wv0xAAAAAElFTkSuQmCC"},8453:(e,a,n)=>{n.d(a,{R:()=>r,x:()=>t});var s=n(6540);const i={},o=s.createContext(i);function r(e){const a=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:a},e.children)}}}]);