"use strict";(self.webpackChunkacd=self.webpackChunkacd||[]).push([[4314],{4360:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>o,frontMatter:()=>t,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"task/vehicle_guidance/Trajectory-Control","title":"Trajectory Control","description":"ROS1","source":"@site/docs/task/04_vehicle_guidance/01_Trajectory-Control.md","sourceDirName":"task/04_vehicle_guidance","slug":"/task/vehicle_guidance/Trajectory-Control","permalink":"/Autonomous-Connected-Driving/docs/task/vehicle_guidance/Trajectory-Control","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/task/04_vehicle_guidance/01_Trajectory-Control.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"taskSidebar","previous":{"title":"Vehicle Guidance","permalink":"/Autonomous-Connected-Driving/docs/category/vehicle-guidance"},"next":{"title":"Connected Driving","permalink":"/Autonomous-Connected-Driving/docs/category/connected-driving"}}');var l=n(4848),i=n(8453);const t={},r="Trajectory Control",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Controller Architecture",id:"controller-architecture",level:3},{value:"Repository and Codebase",id:"repository-and-codebase",level:3},{value:"Tasks",id:"tasks",level:2},{value:"Task 1: Implementation of Odometry Equations",id:"task-1-implementation-of-odometry-equations",level:3},{value:"Task 2: Calculate the Control Deviations",id:"task-2-calculate-the-control-deviations",level:3},{value:"Task 3: Implement the Output Equation of a Discrete PID Controller",id:"task-3-implement-the-output-equation-of-a-discrete-pid-controller",level:3},{value:"Task 4: Longitudinal Velocity Controller",id:"task-4-longitudinal-velocity-controller",level:3},{value:"Task 5: Cascaded Lateral Controller",id:"task-5-cascaded-lateral-controller",level:3},{value:"Task 6: Inverse Single-Track Model",id:"task-6-inverse-single-track-model",level:3},{value:"Execution and Simulation",id:"execution-and-simulation",level:2},{value:"Building the Workspace",id:"building-the-workspace",level:3},{value:"Running the Simulation",id:"running-the-simulation",level:3},{value:"Expected Outcome",id:"expected-outcome",level:3},{value:"Bonus Task",id:"bonus-task",level:2},{value:"Steps:",id:"steps",level:3},{value:"Wrap-up",id:"wrap-up",level:2},{value:"References",id:"references",level:2}];function h(e){const s={a:"a",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",msup:"msup",mtext:"mtext",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"trajectory-control",children:"Trajectory Control"})}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.img,{src:"https://img.shields.io/badge/ROS1-blue",alt:"ROS1"})}),"\n",(0,l.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(s.p,{children:"In autonomous vehicle systems, maintaining precise control over the vehicle's trajectory is paramount for safety and performance. In previous workshops, it was observed that the vehicle occasionally deviates from its planned path, leading to corrective maneuvers that realign it with the desired trajectory. This behavior stems from the implementation of a Bi-Level-Stabilization guidance system. However, the absence of a low-level stabilization controller in earlier sessions meant that the vehicle couldn't accurately follow the high-level trajectory planner's directives. When deviations exceeded a certain threshold, the Model Predictive Control (MPC) system was reinitialized using the vehicle's current state, causing abrupt realignments."}),"\n",(0,l.jsx)(s.p,{children:"This workshop aims to bridge that gap by implementing a comprehensive low-level stabilization controller, enhancing the vehicle's ability to adhere to planned trajectories seamlessly."}),"\n",(0,l.jsx)(s.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,l.jsx)(s.p,{children:"By the end of this workshop, participants will be able to:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Implement Odometry Equations:"})," Calculate the lateral and heading deviations of the vehicle relative to the planned trajectory."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Compute Control Deviations:"})," Utilize target trajectory values and the current vehicle state to determine control deviations."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Derive Discrete PID Controller Output:"})," Formulate the output equation for a discrete PID controller."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Develop Velocity and Lateral Controllers:"})," Implement a longitudinal velocity controller and a cascaded lateral controller that determines the desired yaw rate."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Apply Inverse Single-Track Model:"})," Convert the desired yaw rate into an appropriate steering angle using an inverse single-track model."]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"introduction",children:"Introduction"}),"\n",(0,l.jsx)(s.p,{children:"The core objective of this workshop is to implement a compensatory feedback controller serving as the low-level stabilization mechanism within the vehicle's guidance system. This controller works in tandem with the high-level trajectory planner to ensure smooth and accurate trajectory following."}),"\n",(0,l.jsx)(s.h3,{id:"controller-architecture",children:"Controller Architecture"}),"\n",(0,l.jsx)(s.p,{children:"The controller's architecture is visually represented below:"}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.img,{alt:"Controller Architecture",src:n(7950).A+"",width:"1086",height:"502"})}),"\n",(0,l.jsx)(s.p,{children:"The architecture comprises various components responsible for different aspects of trajectory control. Participants will be required to fill in specific sections within the controller's codebase to complete the implementation."}),"\n",(0,l.jsx)(s.h3,{id:"repository-and-codebase",children:"Repository and Codebase"}),"\n",(0,l.jsx)(s.p,{children:"The foundational code for this workshop is hosted on GitHub. Participants should focus on the following files, which contain designated gaps to be filled:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Trajectory Controller:"})," ",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/TrajectoryCtrl.cpp",children:"TrajectoryCtrl.cpp"})]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"PID Controller:"})," ",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/PID.cpp",children:"PID.cpp"})]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"tasks",children:"Tasks"}),"\n",(0,l.jsx)(s.h3,{id:"task-1-implementation-of-odometry-equations",children:"Task 1: Implementation of Odometry Equations"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Objective:"})," Implement the odometry equations to determine the vehicle's lateral (",(0,l.jsx)(s.code,{children:"dy_"}),") and heading (",(0,l.jsx)(s.code,{children:"dpsi_"}),") deviations from the planned trajectory."]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Steps:"})}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Navigate to the Code:"}),"\nOpen the ",(0,l.jsx)(s.code,{children:"TrajectoryCtrl.cpp"})," file and locate line 242:\n",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/TrajectoryCtrl.cpp#L242",children:"TrajectoryCtrl.cpp at Line 242"})]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Fill in the Gaps:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-c++",children:"// START TASK 1 CODE HERE\n// use helping comments from Wiki\ndouble yawRate = cur_vehicle_state_.yaw_rate;\ndouble velocity = cur_vehicle_state_.velocity;\nodom_dy_ += sin(dpsi_ + 0.5 * yawRate * dt) * (velocity * dt);\nodom_dpsi_ += yawRate * dt;\n// END TASK 1 CODE HERE\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Hints:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Variables:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"yawRate"}),": Current yaw rate of the vehicle."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"velocity"}),": Current velocity of the vehicle."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"dt"}),": Time step since the last odometry update."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Formulas:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.strong,{children:"Lateral Movement:"})}),"\n"]}),"\n",(0,l.jsx)(s.span,{className:"katex-display",children:(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"y"}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsx)(s.mi,{children:"sin"}),(0,l.jsx)(s.mo,{children:"\u2061"}),(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mo,{fence:"true",children:"("}),(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"\u03c8"}),(0,l.jsx)(s.mo,{children:"+"}),(0,l.jsx)(s.mn,{children:"0.5"}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsxs)(s.mover,{accent:"true",children:[(0,l.jsx)(s.mi,{children:"\u03c8"}),(0,l.jsx)(s.mo,{children:"\u02d9"})]}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"t"}),(0,l.jsx)(s.mo,{fence:"true",children:")"})]}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"s"})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"dy = \\sin\\left(d\\psi + 0.5 \\cdot \\dot{\\psi} \\cdot dt\\right) \\cdot ds"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1.8em",verticalAlign:"-0.65em"}}),(0,l.jsx)(s.span,{className:"mop",children:"sin"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(s.span,{className:"minner",children:[(0,l.jsx)(s.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,l.jsx)(s.span,{className:"delimsizing size2",children:"("})}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"+"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mord",children:"0.5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mord accent",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,l.jsxs)(s.span,{style:{top:"-3em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"})]}),(0,l.jsxs)(s.span,{style:{top:"-3.2634em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"accent-body",style:{left:"-0.0278em"},children:(0,l.jsx)(s.span,{className:"mord",children:"\u02d9"})})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.1944em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,l.jsx)(s.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,l.jsx)(s.span,{className:"delimsizing size2",children:")"})})]}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"s"})]})]})]})}),"\n",(0,l.jsx)(s.p,{children:"Where ( ds = velocity \\cdot dt ) is the distance traveled since the last update."}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.strong,{children:"Heading Change:"})}),"\n"]}),"\n",(0,l.jsx)(s.span,{className:"katex-display",children:(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"\u03c8"}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsxs)(s.mover,{accent:"true",children:[(0,l.jsx)(s.mi,{children:"\u03c8"}),(0,l.jsx)(s.mo,{children:"\u02d9"})]}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"t"})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"d\\psi = \\dot{\\psi} \\cdot dt"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1.1257em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(s.span,{className:"mord accent",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,l.jsxs)(s.span,{style:{top:"-3em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"})]}),(0,l.jsxs)(s.span,{style:{top:"-3.2634em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"accent-body",style:{left:"-0.0278em"},children:(0,l.jsx)(s.span,{className:"mord",children:"\u02d9"})})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.1944em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"t"})]})]})]})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"task-2-calculate-the-control-deviations",children:"Task 2: Calculate the Control Deviations"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Objective:"})," Utilize the odometry outputs to compute the vehicle's deviations from the current trajectory."]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Steps:"})}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Navigate to the Code:"}),"\nOpen the ",(0,l.jsx)(s.code,{children:"TrajectoryCtrl.cpp"})," file and locate line 196:\n",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/TrajectoryCtrl.cpp#L196",children:"TrajectoryCtrl.cpp at Line 196"})]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Fill in the Gaps:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-c++",children:"// START TASK 2 CODE HERE\n// calculate vehicle deviations from the trajectory\n// use helping comments from Wiki\ndy_ = odom_dy_ - target_dy;\ndpsi_ = odom_dpsi_ - target_dpsi;\n// END TASK 2 CODE HERE\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Hints:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Variables:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"odom_dy_"}),": Calculated lateral deviation from odometry."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"odom_dpsi_"}),": Calculated heading deviation from odometry."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"target_dy"}),": Desired lateral position from the trajectory."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"target_dpsi"}),": Desired heading from the trajectory."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"task-3-implement-the-output-equation-of-a-discrete-pid-controller",children:"Task 3: Implement the Output Equation of a Discrete PID Controller"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Objective:"})," Develop the output equation for a discrete PID controller to establish a feedback control loop based on the calculated deviations."]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Steps:"})}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Navigate to the Code:"}),"\nOpen the ",(0,l.jsx)(s.code,{children:"PID.cpp"})," file and locate line 44:\n",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/PID.cpp#L44",children:"PID.cpp at Line 44"})]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Fill in the Gaps:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-c++",children:"// START TASK 3 CODE HERE\n// use helping comments from Wiki\ni_val_ += e * dt;\ndouble d_val = (e - prev_e_) / dt;\nprev_e_ = e;\nreturn Kp_ * e + Ki_ * i_val_ + Kd_ * d_val;\n// END TASK 3 CODE HERE\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Hints:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Variables:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"e"}),": Controller error."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"i_val_"}),": Integral of the controller error."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"d_val"}),": Derivative of the controller error."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"Kp_"}),", ",(0,l.jsx)(s.code,{children:"Ki_"}),", ",(0,l.jsx)(s.code,{children:"Kd_"}),": Proportional, Integral, and Derivative gains respectively."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Equation:"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.span,{className:"katex-display",children:(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mtext,{children:"Output"}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsxs)(s.msub,{children:[(0,l.jsx)(s.mi,{children:"K"}),(0,l.jsx)(s.mi,{children:"p"})]}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsx)(s.mi,{children:"e"}),(0,l.jsx)(s.mo,{children:"+"}),(0,l.jsxs)(s.msub,{children:[(0,l.jsx)(s.mi,{children:"K"}),(0,l.jsx)(s.mi,{children:"i"})]}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsx)(s.mo,{children:"\u222b"}),(0,l.jsx)(s.mi,{children:"e"}),(0,l.jsx)(s.mtext,{children:"\u2009"}),(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"t"}),(0,l.jsx)(s.mo,{children:"+"}),(0,l.jsxs)(s.msub,{children:[(0,l.jsx)(s.mi,{children:"K"}),(0,l.jsx)(s.mi,{children:"d"})]}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsxs)(s.mfrac,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"e"})]}),(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"t"})]})]})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"  \\text{Output} = K_p \\cdot e + K_i \\cdot \\int e \\, dt + K_d \\cdot \\frac{de}{dt}"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.8778em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(s.span,{className:"mord text",children:(0,l.jsx)(s.span,{className:"mord",children:"Output"})}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,l.jsx)(s.span,{className:"msupsub",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(s.span,{className:"mord mathnormal mtight",children:"p"})})]})}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(s.span,{})})})]})})]}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"+"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,l.jsx)(s.span,{className:"msupsub",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,l.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(s.span,{})})})]})})]}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"2.2222em",verticalAlign:"-0.8622em"}}),(0,l.jsx)(s.span,{className:"mop op-symbol large-op",style:{marginRight:"0.44445em",position:"relative",top:"-0.0011em"},children:"\u222b"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"+"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,l.jsx)(s.span,{className:"msupsub",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.3361em"},children:(0,l.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(s.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(s.span,{})})})]})})]}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"2.0574em",verticalAlign:"-0.686em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(s.span,{className:"mfrac",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"1.3714em"},children:[(0,l.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"t"})]})]}),(0,l.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"e"})]})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,l.jsx)(s.h3,{id:"task-4-longitudinal-velocity-controller",children:"Task 4: Longitudinal Velocity Controller"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Objective:"})," Implement a longitudinal velocity controller using the PID controller to manage the vehicle's speed."]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Steps:"})}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Navigate to the Code:"}),"\nOpen the ",(0,l.jsx)(s.code,{children:"TrajectoryCtrl.cpp"})," file and locate line 345:\n",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/TrajectoryCtrl.cpp#L345",children:"TrajectoryCtrl.cpp at Line 345"})]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Fill in the Gaps:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-c++",children:"// START TASK 4 CODE HERE\n// use helping comments from Wiki\ndouble dt = ros::Time::now().toSec() - vhcl_ctrl_output_.header.stamp.toSec();\ndouble velocity = cur_vehicle_state_.velocity;\ndouble w_v = v_tgt_;\ndouble e_v = w_v - velocity;\ndouble a_fb_v = dv_pid.Calc(e_v, dt);\n// END TASK 4 CODE HERE\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Hints:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Variables:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"w_v"}),": Desired (target) velocity."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"velocity"}),": Current vehicle velocity."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"e_v"}),": Velocity error."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"a_fb_v"}),": Feedback acceleration command."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"PID Controller Instance:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"dv_pid"}),": Instance of the velocity PID controller."]}),"\n",(0,l.jsxs)(s.li,{children:["Method: ",(0,l.jsx)(s.code,{children:"Calc(double e, double dt)"})," computes the PID output based on the error and time step."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"task-5-cascaded-lateral-controller",children:"Task 5: Cascaded Lateral Controller"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Objective:"})," Develop a cascaded lateral feedback controller that computes the desired yaw rate based on lateral and heading deviations."]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Steps:"})}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Navigate to the Code:"}),"\nOpen the ",(0,l.jsx)(s.code,{children:"TrajectoryCtrl.cpp"})," file and locate line 262:\n",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/TrajectoryCtrl.cpp#L262",children:"TrajectoryCtrl.cpp at Line 262"})]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Fill in the Gaps:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-c++",children:"// START TASK 5 CODE HERE\n// use helping comments from Wiki\ndouble dt = (ros::Time::now() - vhcl_ctrl_output_.header.stamp).toSec();\ndouble w_y = 0.0; // Desired lateral position can be set or computed as needed\ndouble e_y = dy_ - w_y;\ndouble w_psi = 0.0; // Desired heading can be set or computed as needed\ndouble e_psi = dpsi_ - w_psi;\ndouble psi_dot_des = dy_pid.Calc(e_y, dt) + dpsi_pid.Calc(e_psi, dt);\n// END TASK 5 CODE HERE\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Hints:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Variables:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"dy_"}),": Lateral deviation from the trajectory."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"dpsi_"}),": Heading deviation from the trajectory."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"w_y"}),": Desired lateral position (often set to zero if following the trajectory precisely)."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"w_psi"}),": Desired heading (often aligned with the trajectory's heading)."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"psi_dot_des"}),": Desired yaw rate computed from the PID controllers."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"PID Controller Instances:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"dy_pid"}),": PID controller for lateral deviation."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"dpsi_pid"}),": PID controller for heading deviation."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Method:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"Calc(double e, double dt)"})," computes the PID output based on the error and time step."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"task-6-inverse-single-track-model",children:"Task 6: Inverse Single-Track Model"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Objective:"})," Convert the desired yaw rate into an appropriate steering angle using the inverse single-track (bicycle) model."]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Steps:"})}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Navigate to the Code:"}),"\nOpen the ",(0,l.jsx)(s.code,{children:"TrajectoryCtrl.cpp"})," file and locate line 287:\n",(0,l.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_4/trajectory_ctrl/src/TrajectoryCtrl.cpp#L287",children:"TrajectoryCtrl.cpp at Line 287"})]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Fill in the Gaps:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-c++",children:"// START TASK 6 CODE HERE\n// use helping comments from Wiki\ndouble st_ang_pid = (psi_dot_des * (wheelbase_ + self_st_gradient_ * velocity * velocity)) / velocity;\n// END TASK 6 CODE HERE\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Hints:"})}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Variables:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"self_st_gradient_"})," ",(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"E"}),(0,l.jsx)(s.mi,{children:"G"})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"EG"})]})})}),(0,l.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"EG"})]})})]}),": Vehicle's self-steering gradient."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"wheelbase_"})," ",(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsx)(s.mrow,{children:(0,l.jsx)(s.mi,{children:"l"})}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"l "})]})})}),(0,l.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"})]})})]}),": Distance between the front and rear axles."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"velocity"})," ",(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsx)(s.mrow,{children:(0,l.jsx)(s.mi,{children:"v"})}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"v"})]})})}),(0,l.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"})]})})]}),": Current velocity of the vehicle."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"psi_dot_des"})," ",(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsx)(s.mrow,{children:(0,l.jsxs)(s.msub,{children:[(0,l.jsxs)(s.mover,{accent:"true",children:[(0,l.jsx)(s.mi,{children:"\u03c8"}),(0,l.jsx)(s.mo,{children:"\u02d9"})]}),(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"d"}),(0,l.jsx)(s.mi,{children:"e"}),(0,l.jsx)(s.mi,{children:"s"})]})]})}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\dot{\\psi}_{des}"})]})})}),(0,l.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1.1257em",verticalAlign:"-0.1944em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord accent",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,l.jsxs)(s.span,{style:{top:"-3em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"})]}),(0,l.jsxs)(s.span,{style:{top:"-3.2634em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"accent-body",style:{left:"-0.0278em"},children:(0,l.jsx)(s.span,{className:"mord",children:"\u02d9"})})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.1944em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"msupsub",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.3361em"},children:(0,l.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(s.span,{className:"mord mtight",children:[(0,l.jsx)(s.span,{className:"mord mathnormal mtight",children:"d"}),(0,l.jsx)(s.span,{className:"mord mathnormal mtight",children:"es"})]})})]})}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(s.span,{})})})]})})]})]})})]}),": Desired yaw rate."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.li,{children:(0,l.jsx)(s.strong,{children:"Formula:"})}),"\n"]}),"\n",(0,l.jsx)(s.span,{className:"katex-display",children:(0,l.jsxs)(s.span,{className:"katex",children:[(0,l.jsx)(s.span,{className:"katex-mathml",children:(0,l.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(s.semantics,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mi,{children:"\u03b4"}),(0,l.jsx)(s.mo,{children:"="}),(0,l.jsxs)(s.mover,{accent:"true",children:[(0,l.jsx)(s.mi,{children:"\u03c8"}),(0,l.jsx)(s.mo,{children:"\u02d9"})]}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsxs)(s.mfrac,{children:[(0,l.jsxs)(s.mrow,{children:[(0,l.jsx)(s.mo,{stretchy:"false",children:"("}),(0,l.jsx)(s.mi,{children:"l"}),(0,l.jsx)(s.mo,{children:"+"}),(0,l.jsx)(s.mi,{children:"E"}),(0,l.jsx)(s.mi,{children:"G"}),(0,l.jsx)(s.mo,{children:"\u22c5"}),(0,l.jsxs)(s.msup,{children:[(0,l.jsx)(s.mi,{children:"v"}),(0,l.jsx)(s.mn,{children:"2"})]}),(0,l.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(s.mi,{children:"v"})]})]}),(0,l.jsx)(s.annotation,{encoding:"application/x-tex",children:"  \\delta = \\dot{\\psi} \\cdot \\frac{(l + EG \\cdot v^2)}{v}"})]})})}),(0,l.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03785em"},children:"\u03b4"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(s.span,{className:"mrel",children:"="}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"1.1257em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(s.span,{className:"mord accent",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"0.9313em"},children:[(0,l.jsxs)(s.span,{style:{top:"-3em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c8"})]}),(0,l.jsxs)(s.span,{style:{top:"-3.2634em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"accent-body",style:{left:"-0.0278em"},children:(0,l.jsx)(s.span,{className:"mord",children:"\u02d9"})})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.1944em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(s.span,{className:"base",children:[(0,l.jsx)(s.span,{className:"strut",style:{height:"2.1771em",verticalAlign:"-0.686em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(s.span,{className:"mfrac",children:(0,l.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(s.span,{className:"vlist-r",children:[(0,l.jsxs)(s.span,{className:"vlist",style:{height:"1.4911em"},children:[(0,l.jsxs)(s.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"mord",children:(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"})})]}),(0,l.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(s.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mopen",children:"("}),(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"+"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mord mathnormal",children:"EG"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(s.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(s.span,{className:"mord",children:[(0,l.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,l.jsx)(s.span,{className:"msupsub",children:(0,l.jsx)(s.span,{className:"vlist-t",children:(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.8141em"},children:(0,l.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,l.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(s.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,l.jsx)(s.span,{className:"mclose",children:")"})]})]})]}),(0,l.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(s.span,{className:"vlist-r",children:(0,l.jsx)(s.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(s.span,{})})})]})}),(0,l.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,l.jsx)(s.p,{children:"Where ( \\delta ) is the steering angle."}),"\n",(0,l.jsx)(s.h2,{id:"execution-and-simulation",children:"Execution and Simulation"}),"\n",(0,l.jsx)(s.h3,{id:"building-the-workspace",children:"Building the Workspace"}),"\n",(0,l.jsx)(s.p,{children:"Once all tasks are completed, it's time to build the workspace and run the simulation to observe the controller in action."}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Start the Docker Container:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"cd acdc/docker\n./ros1_run.sh\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Build the Workspace:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"catkin build\nsource devel/setup.bash\n"})}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.em,{children:"Note: Ensure you source the setup file in every new terminal session."})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"running-the-simulation",children:"Running the Simulation"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Launch the Vehicle Guidance System:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"roslaunch trajectory_planner vehicle_guidance.launch\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Introduce Dynamic Objects:"}),"\nIn a separate terminal within the Docker container, play a pre-recorded bag file to simulate dynamic obstacles:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"rosbag play ~/ws/bag/acdc_fusion_guidance_noise.bag\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"expected-outcome",children:"Expected Outcome"}),"\n",(0,l.jsx)(s.p,{children:"Upon successful implementation and execution, the vehicle should adhere closely to the planned trajectory, demonstrating improved stability and control compared to previous configurations. The simulation should resemble the following:"}),"\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.img,{alt:"Solution",src:n(7881).A+"",width:"666",height:"360"})}),"\n",(0,l.jsx)(s.h2,{id:"bonus-task",children:"Bonus Task"}),"\n",(0,l.jsx)(s.p,{children:"Enhance your understanding of the controller's dynamics by experimenting with real-time parameter adjustments."}),"\n",(0,l.jsx)(s.h3,{id:"steps",children:"Steps:"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Open Dynamic Reconfigure Interface:"}),"\nIn a new terminal, execute:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"source devel/setup.bash\nrosrun rqt_reconfigure rqt_reconfigure\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Adjust Parameters:"}),"\nA graphical interface will appear, allowing you to tweak various parameters of the trajectory planner and controller. Key adjustments include:"]}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Controller Gains:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Set ",(0,l.jsx)(s.code,{children:"dv_P"}),", ",(0,l.jsx)(s.code,{children:"dv_I"}),", ",(0,l.jsx)(s.code,{children:"dv_D"}),", etc., to zero to disable feedback control, reverting to behavior observed in earlier workshops."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Deviation Parameters:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Set ",(0,l.jsx)(s.code,{children:"deviationMax..."})," parameters to zero, making the MPC reinitialize every optimization step and disable low-level stabilization."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Cost Function Weights:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Modify the weights and reference factors to observe their impact on trajectory adherence and control smoothness."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Observe Effects:"}),"\nMonitor how changes influence the vehicle's behavior in the simulation. This hands-on experience solidifies the understanding of controller dynamics and the significance of each parameter."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"wrap-up",children:"Wrap-up"}),"\n",(0,l.jsx)(s.p,{children:"Through this workshop, participants have:"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Implemented Odometry Equations:"})," Calculated lateral and heading deviations relative to the planned trajectory."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Computed Control Deviations:"})," Utilized trajectory targets and vehicle state to determine necessary control adjustments."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Developed a Discrete PID Controller:"})," Formulated and implemented the output equation for effective feedback control."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Established Velocity and Lateral Controllers:"})," Created controllers for managing longitudinal speed and lateral positioning, culminating in the computation of desired yaw rates."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Applied the Inverse Single-Track Model:"})," Translated desired yaw rates into steering angles, completing the control loop for trajectory adherence."]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"These skills are foundational for developing robust autonomous vehicle systems capable of precise and reliable trajectory following."}),"\n",(0,l.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsx)(s.p,{children:(0,l.jsx)(s.strong,{children:"Control Toolbox:"})}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{children:'@article{adrlCT,\n  title={The control toolbox \u2014 An open-source C++ library for robotics, optimal and model predictive control},\n  author={Markus Giftthaler and Michael Neunert and Markus St{\\"a}uble and Jonas Buchli},\n  journal={2018 IEEE International Conference on Simulation, Modeling, and Programming for Autonomous Robots (SIMPAR)},\n  year={2018},\n  pages={123-129}\n}\n'})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Flatland:"})," ",(0,l.jsx)(s.a,{href:"https://github.com/avidbots/flatland",children:"https://github.com/avidbots/flatland"})]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"ROS (Robot Operating System):"})," ",(0,l.jsx)(s.a,{href:"https://www.ros.org",children:"https://www.ros.org"})]}),"\n"]}),"\n"]})]})}function o(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},7950:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/ctr_arc-cf9536dcba0fb3279c2bea747901587b.PNG"},7881:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/sol_control-d4c6daa4c1c52786190644cc43473c7a.gif"},8453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>r});var a=n(6540);const l={},i=a.createContext(l);function t(e){const s=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),a.createElement(i.Provider,{value:s},e.children)}}}]);