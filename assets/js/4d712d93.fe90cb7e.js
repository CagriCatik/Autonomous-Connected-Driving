"use strict";(self.webpackChunkacd=self.webpackChunkacd||[]).push([[9781],{8092:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"task/intro/ROS-Application","title":"ROS Application","description":"ROS1","source":"@site/docs/task/01_intro/06_ROS-Application.md","sourceDirName":"task/01_intro","slug":"/task/intro/ROS-Application","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS-Application","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/task/01_intro/06_ROS-Application.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"taskSidebar","previous":{"title":"ROS Bags","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS-Bags"},"next":{"title":"ROS2 Outlook","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS2-Outlook"}}');var a=t(4848),s=t(8453);const r={},l="ROS Application",o={},c=[{value:"Task",id:"task",level:2},{value:"Lap time challenge",id:"lap-time-challenge",level:2},{value:"Background information",id:"background-information",level:2},{value:"Lidar measurements input data",id:"lidar-measurements-input-data",level:3},{value:"Vehicle model and output data",id:"vehicle-model-and-output-data",level:3},{value:"Our Implementation",id:"our-implementation",level:3},{value:"Wrap-up",id:"wrap-up",level:2}];function h(e){const n={a:"a",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",math:"math",mi:"mi",mo:"mo",mrow:"mrow",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"ros-application",children:"ROS Application"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{src:"https://img.shields.io/badge/ROS1-blue",alt:"ROS1"})}),"\n",(0,a.jsx)(n.p,{children:"Now we already learned some basic concepts about C++ and ROS and should be able to solve our first real automated driving challenge. Hence, we consider again the simple vehicle controller from the previous units and finally try to improve the laptimes of the race car in the simulation environment."}),"\n",(0,a.jsx)(n.p,{children:"In this exercise you will"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"learn the theory behind our implementation for the vehicle controller"}),"\n",(0,a.jsx)(n.li,{children:"try to improve the target velocity and steering functions for improving the laptime"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"task",children:"Task"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Implement your own version of the vehicle controller"})," in the file"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"~/ws/catkin_workspace/src/workshops/section_1/racing/src/VehicleController.cpp"}),"."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"In particular:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Implement an improved longitudinal control rule in ",(0,a.jsx)(n.code,{children:"computeTargetVelocity()"})]}),"\n",(0,a.jsxs)(n.li,{children:["Implement an improved lateral control rule in ",(0,a.jsx)(n.code,{children:"computeTargetSteeringAngle()"})]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Try to achieve ",(0,a.jsx)(n.strong,{children:"at least one lap without major wall crashes"}),". Be creative and use any sort of scaling factors or mathematical functions that help you implement a fast and smooth vehicle behavior. You can also have a look to the ",(0,a.jsx)(n.a,{href:"#background-information",children:"background information"})," below."]}),"\n",(0,a.jsxs)(n.p,{children:["\u2139\ufe0f"," Do not forget to ",(0,a.jsx)(n.em,{children:"save"})," your source files and ",(0,a.jsx)(n.em,{children:"build"})," your source code in between making changes and trying them out:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"catkin build racing --no-deps  # only build racing package (faster)\n"})}),"\n",(0,a.jsx)(n.p,{children:"After that you can start again the simulation environment as well as the vehicle controller with the already known commands:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"roslaunch racing flatland_simulation.launch\nroslaunch racing racing_controller.launch\n"})}),"\n",(0,a.jsx)(n.h2,{id:"lap-time-challenge",children:"Lap time challenge"}),"\n",(0,a.jsxs)(n.p,{children:["Visit ",(0,a.jsx)(n.a,{href:"https://github.com/ika-rwth-aachen/acdc/wiki/Section-1-Lap-Time-Challenge",children:"Lap Time Challenge"})," to submit your code and participate in the lap time challenge."]}),"\n",(0,a.jsx)(n.h2,{id:"background-information",children:"Background information"}),"\n",(0,a.jsx)(n.p,{children:"This task is an extreme simplification of a real-world automated driving function. The simplifications here are explained in the following."}),"\n",(0,a.jsx)(n.h3,{id:"lidar-measurements-input-data",children:"Lidar measurements input data"}),"\n",(0,a.jsxs)(n.p,{children:["Both of your functions should make use of the available sensor data, whose definition you can look up in ",(0,a.jsx)(n.code,{children:"racing/include/VehicleController.h"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"float sensor_distances_[5] = {0.0f, 0.0f, 0.0f, 0.0f, 0.0f}; ///< order: right, front-right, front, front-left, left\n"})}),"\n",(0,a.jsx)("img",{src:"../images/section_1/lidar.png",width:"300",height:""}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The current implementation only uses three of the five available LiDAR points. Using more sensor data could naturally improve the driving behavior."}),"\n",(0,a.jsx)(n.li,{children:"Base the longitudinal control on the front measurement, and the lateral control on the left and right measurements."}),"\n",(0,a.jsx)(n.li,{children:"There is artificial noise on the measurement data, which may lead to unreproducible vehicle behavior and different lap times."}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"vehicle-model-and-output-data",children:"Vehicle model and output data"}),"\n",(0,a.jsxs)(n.p,{children:["Your task is to set ",(0,a.jsx)(n.em,{children:"target"})," values for"]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{}),(0,a.jsx)(n.th,{children:"name in figure below"}),(0,a.jsx)(n.th,{children:"name in code"}),(0,a.jsx)(n.th,{style:{textAlign:"right"},children:"positive orientation"}),(0,a.jsx)(n.th,{children:"unit"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"velocity"}),(0,a.jsx)(n.td,{children:(0,a.jsxs)(n.span,{className:"katex",children:[(0,a.jsx)(n.span,{className:"katex-mathml",children:(0,a.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(n.semantics,{children:[(0,a.jsx)(n.mrow,{children:(0,a.jsx)(n.mi,{children:"v"})}),(0,a.jsx)(n.annotation,{encoding:"application/x-tex",children:"v "})]})})}),(0,a.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(n.span,{className:"base",children:[(0,a.jsx)(n.span,{className:"strut",style:{height:"0.4306em"}}),(0,a.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"})]})})]})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"this->target_velocity_"})}),(0,a.jsx)(n.td,{style:{textAlign:"right"},children:"forward"}),(0,a.jsx)(n.td,{children:"m/s"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"steering angle"}),(0,a.jsx)(n.td,{children:(0,a.jsxs)(n.span,{className:"katex",children:[(0,a.jsx)(n.span,{className:"katex-mathml",children:(0,a.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(n.semantics,{children:[(0,a.jsx)(n.mrow,{children:(0,a.jsx)(n.mi,{children:"\u03b4"})}),(0,a.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\delta "})]})})}),(0,a.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(n.span,{className:"base",children:[(0,a.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,a.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03785em"},children:"\u03b4"})]})})]})}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"this->target_steering_angle_"})}),(0,a.jsx)(n.td,{style:{textAlign:"right"},children:"counterclockwise"}),(0,a.jsx)(n.td,{children:"rad"})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["These two values are part of the ",(0,a.jsx)(n.strong,{children:"kinematic single track model"}),", which is illustrated in the picture below."]}),"\n",(0,a.jsx)("img",{src:"../images/kinematic_single_track_model.PNG",alt:"Description of image"}),"\n",(0,a.jsxs)(n.p,{children:["This ",(0,a.jsx)(n.strong,{children:"vehicle model"})," assumes:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"wheel orientations exactly determine the direction of motion of the vehicle"}),"\n",(0,a.jsx)(n.li,{children:"wheels of an axle can be represented by a single wheel in the middle"}),"\n",(0,a.jsx)(n.li,{children:"wheels roll without slipping and friction"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Furthermore, an ",(0,a.jsx)(n.strong,{children:"actuator model"})," is employed to take into account that the actuators cannot immediately realize any target value we specify. The currently implemented constraints are (from ",(0,a.jsx)(n.code,{children:"racing/resources/racing_cart.yaml"}),"):"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"    max_angular_velocity: 1.5\n    max_steering_angle: 0.7\n    max_forward_velocity: 30\n    max_backward_velocity: 5\n    max_linear_acceleration: 3.0\n    max_linear_deceleration: 8.0\n"})}),"\n",(0,a.jsx)(n.h3,{id:"our-implementation",children:"Our Implementation"}),"\n",(0,a.jsxs)(n.p,{children:["We use the ",(0,a.jsxs)(n.span,{className:"katex",children:[(0,a.jsx)(n.span,{className:"katex-mathml",children:(0,a.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(n.semantics,{children:[(0,a.jsxs)(n.mrow,{children:[(0,a.jsx)(n.mi,{mathvariant:"normal",children:"t"}),(0,a.jsx)(n.mi,{mathvariant:"normal",children:"a"}),(0,a.jsx)(n.mi,{mathvariant:"normal",children:"n"}),(0,a.jsx)(n.mi,{mathvariant:"normal",children:"h"}),(0,a.jsx)(n.mo,{stretchy:"false",children:"("}),(0,a.jsx)(n.mo,{stretchy:"false",children:")"})]}),(0,a.jsx)(n.annotation,{encoding:"application/x-tex",children:"\\mathrm{tanh()}"})]})})}),(0,a.jsx)(n.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(n.span,{className:"base",children:[(0,a.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,a.jsxs)(n.span,{className:"mord",children:[(0,a.jsx)(n.span,{className:"mord mathrm",children:"tanh"}),(0,a.jsx)(n.span,{className:"mopen",children:"("}),(0,a.jsx)(n.span,{className:"mclose",children:")"})]})]})})]})," function to get a behavior from input to output that is similar to proportional, but limits the output for large input values:"]}),"\n",(0,a.jsxs)(n.p,{children:["Image source: ",(0,a.jsx)(n.a,{href:"https://de.wikipedia.org/wiki/Datei:Hyperbolic_Tangent.svg",children:"Wikipedia"}),", from Geek3 (",(0,a.jsx)(n.a,{href:"https://creativecommons.org/licenses/by-sa/3.0/deed.en",children:"CC BY-SA 3.0"}),")"]}),"\n",(0,a.jsx)(n.h2,{id:"wrap-up",children:"Wrap-up"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"You learned some theory about the kinematic single track model"}),"\n",(0,a.jsx)(n.li,{children:"You learned how we implemented desired target velocity and target steering angle"}),"\n",(0,a.jsx)(n.li,{children:"You learned some alternatives ways to improve the vehicle model's behavior"}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(6540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);