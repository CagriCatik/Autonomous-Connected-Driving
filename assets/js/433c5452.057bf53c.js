"use strict";(self.webpackChunkacd=self.webpackChunkacd||[]).push([[7164],{6315:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"task/intro/ROS2-Outlook","title":"ROS2 Outlook","description":"ROS1","source":"@site/docs/task/01_intro/07_ROS2-Outlook.md","sourceDirName":"task/01_intro","slug":"/task/intro/ROS2-Outlook","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS2-Outlook","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/task/01_intro/07_ROS2-Outlook.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{},"sidebar":"taskSidebar","previous":{"title":"ROS Application","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS-Application"},"next":{"title":"ROS2 Tutorial in C++","permalink":"/Autonomous-Connected-Driving/docs/task/intro/ROS2-Tutorial-in-Cpp"}}');var i=o(4848),s=o(8453);const t={},a="ROS2 Outlook",c={},l=[{value:"Installation of ROS2",id:"installation-of-ros2",level:2},{value:"Build the ROS2 workspace",id:"build-the-ros2-workspace",level:2},{value:"Start a ROS2 node",id:"start-a-ros2-node",level:2},{value:"Note about ROS2 launch files",id:"note-about-ros2-launch-files",level:3},{value:"Start a ROS1 node",id:"start-a-ros1-node",level:2},{value:"Start the ROS bridge",id:"start-the-ros-bridge",level:2},{value:"Wrap-up",id:"wrap-up",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ros2-outlook",children:"ROS2 Outlook"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.img,{src:"https://img.shields.io/badge/ROS1-blue",alt:"ROS1"}),"\n",(0,i.jsx)(n.img,{src:"https://img.shields.io/badge/ROS2-red",alt:"ROS2"})]}),"\n",(0,i.jsxs)(n.p,{children:["This tutorial provides you with a quick look into ROS2. ROS2 is the successor of ROS1 (we have previously called it ROS for simplicity) and will replace it in future.\nAs of 2022, ROS1 is still more popular and many packages like e.g. ",(0,i.jsx)(n.em,{children:"flatland"}),", which is used in this course, are still being ported to ROS2."]}),"\n",(0,i.jsxs)(n.p,{children:["While the transition is in progress, some packages will have been already ported to ROS2, while some others are only available in ROS1.\nFor such scenarios, you learn how to connect them to a single system using the  so-called ",(0,i.jsx)(n.em,{children:"ROS bridge"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"In this exercise you will"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"learn the rough concepts about ROS2, ROS2 launch and config files"}),"\n",(0,i.jsx)(n.li,{children:"be able to build, source and use ROS1 and ROS2 workspaces, both individual and in parallel"}),"\n",(0,i.jsx)(n.li,{children:"start the racing application with the simulation running in ROS1 and the vehicle controller in ROS2"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"installation-of-ros2",children:"Installation of ROS2"}),"\n",(0,i.jsxs)(n.p,{children:["We already installed all necessary dependencies for ROS2 and the ROS bridge inside of the provided docker image. Have a look into the official ",(0,i.jsx)(n.a,{href:"https://docs.ros.org/en/foxy/Installation/Ubuntu-Install-Debians.html",children:"ROS2 Installation Tutorial"})," for further information."]}),"\n",(0,i.jsx)(n.h2,{id:"build-the-ros2-workspace",children:"Build the ROS2 workspace"}),"\n",(0,i.jsxs)(n.p,{children:["In this step we will build the racing controller in ROS2 using ",(0,i.jsx)(n.code,{children:"colcon"}),", which replaces the ",(0,i.jsx)(n.code,{children:"catkin"})," build system of ROS1."]}),"\n",(0,i.jsxs)(n.p,{children:["\u2139\ufe0f"," With the ",(0,i.jsx)(n.code,{children:"--symlink-install"})," parameter, the files of the package such as configurations and launch files are linked to the corresponding ",(0,i.jsx)(n.code,{children:"src"})," directory instead of copied. This allows us to make changes in the source files (config, launch files) without the need to execute ",(0,i.jsx)(n.code,{children:"colcon build"})," again."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ws/colcon_workspace\nsource /opt/ros/foxy/setup.bash\ncolcon build --packages-select racing --symlink-install \n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u2139\ufe0f"," We will not add the new ",(0,i.jsx)(n.code,{children:"source"})," commands to the ",(0,i.jsx)(n.code,{children:".bashrc"})," script for now, since it may result in problems when both ROS1 and ROS2 are sourced."]}),"\n",(0,i.jsx)(n.h2,{id:"start-a-ros2-node",children:"Start a ROS2 node"}),"\n",(0,i.jsxs)(n.p,{children:["In your fist terminal, ",(0,i.jsx)(n.code,{children:"source"})," the colcon workspace."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source ~/ws/colcon_workspace/install/setup.bash\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Then, start the controller node using ",(0,i.jsx)(n.code,{children:"ros2 launch"}),", which replaces the ROS1 command ",(0,i.jsx)(n.code,{children:"roslaunch"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 launch racing racing_controller.launch.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"note-about-ros2-launch-files",children:"Note about ROS2 launch files"}),"\n",(0,i.jsxs)(n.p,{children:["The code for the demo can be found in the directory ",(0,i.jsx)(n.code,{children:"colcon_workspace/src/section_1/racing"}),". The structure of this ",(0,i.jsx)(n.strong,{children:"Cpp package"})," is illustrated in the following:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"racing/\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 config\n|   \u2514\u2500\u2500 racing.yaml\n\u251c\u2500\u2500 include\n|   \u2514\u2500\u2500 VehicleController.h\n\u251c\u2500\u2500 launch\n|   \u2514\u2500\u2500 racing_controller.launch.py\n\u251c\u2500\u2500 package.xml\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 VehicleController.cpp\n    \u251c\u2500\u2500 vehicle_controller_node.cpp\n    \u2514\u2500\u2500 vehicle_timer_node.cpp\n"})}),"\n",(0,i.jsxs)(n.p,{children:["ROS2 launch file (",(0,i.jsx)(n.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/ce9b1e8b2e4396a8438aa1a692daf0fcffcf4ed4/colcon_workspace/src/section_1/racing/launch/racing_controller.launch.py",children:"racing_controller.launch.py"}),"):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Python script instead of XML file."}),"\n",(0,i.jsx)(n.li,{children:"Mostly describes the node, while the configuration is in a separate file."}),"\n",(0,i.jsxs)(n.li,{children:["See how the ",(0,i.jsx)(n.code,{children:"<node .../>"})," declaration of ROS1 is similar to ",(0,i.jsx)(n.code,{children:"Node(...)"})," code of ROS2."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Importing necessary modules.\nimport os\n# 'get_package_share_directory' is used to find a package's shared directory in a ROS2 environment.\nfrom ament_index_python.packages import get_package_share_directory\n# 'LaunchDescription' helps describe the nodes to be launched in a ROS2 system.\nfrom launch import LaunchDescription\n# 'Node' is an action that represents a node in the ROS2 graph.\nfrom launch_ros.actions import Node\n\ndef generate_launch_description():\n    # Fetching the shared directory path for the 'racing' package.\n    racing_dir = get_package_share_directory('racing')\n    # Constructing the path to the configuration file 'params.yaml'.\n    config = os.path.join(racing_dir, 'config', 'params.yaml')\n\n    # Defining a node for the vehicle_controller.\n    vehicle_controller_node = Node(package='racing', \n                                   executable='vehicle_controller_node',\n                                   name='vehicle_controller_node', \n                                   output='screen',\n                                   parameters=[config])\n    \n    # Defining a node for the vehicle_timer.\n    vehicle_timer_node = Node(package='racing', \n                              executable='vehicle_timer_node',\n                              name='vehicle_timer_node',\n                              output='screen',\n                              parameters=[config])\n\n    # Creating a LaunchDescription object to store the nodes.\n    ld = LaunchDescription()\n\n    # Adding both nodes to the launch description.\n    ld.add_action(vehicle_controller_node)\n    ld.add_action(vehicle_timer_node)\n\n    # Returning the launch description, which is used by the ROS2 launch system.\n    return ld\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The default configuration (",(0,i.jsx)(n.a,{href:"https://git.rwth-aachen.de/ika/acdc/-/blob/00eb696faed7b831f77683758a46247d915f5cfe/colcon_workspace/src/section_2/racing/config/racing.yaml",children:"racing.yaml"}),") is held in an external ",(0,i.jsx)(n.code,{children:".yaml"})," file instead of the launch file itself. This would also be possible in ROS1."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'vehicle_controller_node:\n    ros__parameters:\n        vehicle:\n            sensor_topic: "/vehicle/lidar_measurements"\n            actuator_topic: "/vehicle/actuator_commands"\n\nvehicle_timer_node:\n    ros__parameters:\n        vehicle:\n            position_topic: "/odometry/ground_truth"\n\n'})}),"\n",(0,i.jsx)(n.h2,{id:"start-a-ros1-node",children:"Start a ROS1 node"}),"\n",(0,i.jsx)(n.p,{children:"In your second terminal, start the ROS1 flatland simulation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd ~/ws/catkin_workspace\nsource /opt/ros/noetic/setup.bash\nsource ~/ws/catkin_workspace/devel/setup.bash # this may be already included in your .bashrc\nroslaunch racing flatland_simulation.launch\n"})}),"\n",(0,i.jsx)(n.h2,{id:"start-the-ros-bridge",children:"Start the ROS bridge"}),"\n",(0,i.jsx)(n.p,{children:"Now the racing controller is started in ROS2 and the flatland simulation in ROS1. We can use the bridge to exchange data between ROS1 and ROS2 in both ways."}),"\n",(0,i.jsx)(n.p,{children:"The ROS2 racing controller subscribes to the sensor data from the ROS1 flatland server over the ROS bridge, computes actuator commands and publishes them back to the ROS1 flatland server over the ROS bridge."}),"\n",(0,i.jsx)(n.p,{children:"In your third terminal, source both the ROS1 and the ROS2 version."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/foxy/setup.bash # source ros2 version\nsource /opt/ros/noetic/setup.bash # source ros1 version\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now, start the bridge using ",(0,i.jsx)(n.code,{children:"ros2 run"}),", which replaces the ROS1 command ",(0,i.jsx)(n.code,{children:"rosrun"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ros2 run ros1_bridge dynamic_bridge\n"})}),"\n",(0,i.jsxs)(n.p,{children:["After this, the data of the ROS1 node are linked over the ",(0,i.jsx)(n.code,{children:"ros1_bridge"})," and the vehicle should start moving."]}),"\n",(0,i.jsx)(n.h2,{id:"wrap-up",children:"Wrap-up"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You learned that both ROS versions can be used in parallel within one docker environment."}),"\n",(0,i.jsx)(n.li,{children:"You learned that we can use the ROS bridge to transfer information between ROS1 and ROS2 nodes."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>a});var r=o(6540);const i={},s=r.createContext(i);function t(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);