"use strict";(self.webpackChunkacd=self.webpackChunkacd||[]).push([[7512],{1559:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>c,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"task/object_fusion_tracking/Object-Prediction","title":"Object Prediction","description":"ROS1","source":"@site/docs/task/03_object_fusion_tracking/03_Object-Prediction.md","sourceDirName":"task/03_object_fusion_tracking","slug":"/task/object_fusion_tracking/Object-Prediction","permalink":"/Autonomous-Connected-Driving/docs/task/object_fusion_tracking/Object-Prediction","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/task/03_object_fusion_tracking/03_Object-Prediction.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"taskSidebar","previous":{"title":"Object Fusion","permalink":"/Autonomous-Connected-Driving/docs/task/object_fusion_tracking/Object-Fusion"},"next":{"title":"Vehicle Guidance","permalink":"/Autonomous-Connected-Driving/docs/category/vehicle-guidance"}}');var i=n(4848),t=n(8453);const c={},r="Object Prediction",l={},o=[{value:"Introduction to this workshop",id:"introduction-to-this-workshop",level:2},{value:"Visualize the object detections",id:"visualize-the-object-detections",level:2},{value:"Introduction to the Eigen library",id:"introduction-to-the-eigen-library",level:2},{value:"Introduction to the fusion code",id:"introduction-to-the-fusion-code",level:2},{value:"Task 1: Implement Object Prediction",id:"task-1-implement-object-prediction",level:2},{value:"Updating IkaObjects &quot;in place&quot;",id:"updating-ikaobjects-in-place",level:4},{value:"Prediction code",id:"prediction-code",level:4},{value:"Advanced: Introspection in RViz",id:"advanced-introspection-in-rviz",level:2}];function h(e){const s={a:"a",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h4:"h4",header:"header",img:"img",li:"li",math:"math",mi:"mi",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",mtext:"mtext",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"object-prediction",children:"Object Prediction"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:"https://img.shields.io/badge/ROS1-blue",alt:"ROS1"})}),"\n",(0,i.jsxs)(s.p,{children:["In this workshop, we will program a ",(0,i.jsx)(s.strong,{children:"Multi-Object Tracking"})," step-by-step. We prepared a ",(0,i.jsx)(s.strong,{children:"ROS"})," node for this task, in which you have to implement parts of a ",(0,i.jsx)(s.strong,{children:"Multi-Instance Kalman Filter"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"The learning goals of this workshop are to implement the steps..."}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Object Prediction"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Object Association"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Object Fusion"})}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Furthermore you will learn to..."}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"inspect and visualize a rosbag containing object data"}),"\n",(0,i.jsx)(s.li,{children:"use the Eigen library"}),"\n",(0,i.jsx)(s.li,{children:"utilize advanced RViz features"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"introduction-to-this-workshop",children:"Introduction to this workshop"}),"\n",(0,i.jsx)(s.p,{children:"For this workshop we provide simulated data from a vehicle equipped with a camera and a radar. The camera detects the surrounding objects with a high accuracy in lateral direction but a high uncertainty in longitudinal direction while the radar behaves in exactly the opposite way. The data were simulated on the ika test track."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"You can download the bag file for this workshop here"})," ",(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.a,{href:"https://rwth-aachen.sciebo.de/s/F2M2P4G63aaRryB",children:"Link"})}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["Save the file to the local directory ",(0,i.jsx)(s.code,{children:"acdc/bag"})," on your host. Now start docker (",(0,i.jsx)(s.code,{children:"cd acdc/docker"})," and ",(0,i.jsx)(s.code,{children:"./ros1_run.sh"}),") and inspect the bag file with the command ",(0,i.jsx)(s.code,{children:"rosbag info"})]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rosuser@docker:~/ws/bag$ rosbag info acdc_fusion_guidance_noise.bag\npath:        acdc_fusion_guidance_noise.bag\nversion:     2.0\nduration:    9:59s (599s)\nstart:       Jan 01 1970 01:00:02.51 (2.51)\nend:         Jan 01 1970 01:10:02.50 (602.50)\nsize:        77.4 MB\nmessages:    125992\ncompression: none [102/102 chunks]\ntypes:       definitions/IkaEgoMotion  [e0618c9f9aa211f416eed80f5aa9a953]\n             definitions/IkaGPS        [be18f6276d518be76f37af636e04fd9f]\n             definitions/IkaObjectList [a997953d24fa0f3e837de98bfab1882a]\ntopics:      /ikaGPS                               59993 msgs    : definitions/IkaGPS\n             /sensors/camera_front/ikaObjectList   12000 msgs    : definitions/IkaObjectList\n             /sensors/radar_front/ikaObjectList    12000 msgs    : definitions/IkaObjectList\n             /sensors/reference/ikaObjectList      12000 msgs    : definitions/IkaObjectList\n             /sensors/vehicleCAN/ikaEgoMotion      29999 msgs    : definitions/IkaEgoMotion\n"})}),"\n",(0,i.jsxs)(s.p,{children:["As you can see the file contains the two topics ",(0,i.jsx)(s.code,{children:"/sensors/camera_front/ikaObjectList"})," and ",(0,i.jsx)(s.code,{children:"/sensors/radar_front/ikaObjectList"}),". You already learnt about the definition of an ",(0,i.jsx)(s.code,{children:"ikaObjectList"})," in ",(0,i.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/wiki/Section-2-Object-Detection",children:"section 2"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["Furthermore the ros bag contains the topics ",(0,i.jsx)(s.code,{children:"/ikaGPS"})," and ",(0,i.jsx)(s.code,{children:"/sensors/vehicleCAN/ikaEgoMotion"})," which are responsible for publishing the position of the ego vehicle."]}),"\n",(0,i.jsx)(s.h2,{id:"visualize-the-object-detections",children:"Visualize the object detections"}),"\n",(0,i.jsx)(s.p,{children:"In the docker container, build the workspace:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"catkin build\nsource devel/setup.bash # make sure to execute this line in each of the following terminals!\n"})}),"\n",(0,i.jsx)(s.p,{children:"Then, execute in different terminals:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"roslaunch acdc_launchpack bag_playback.launch\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rosbag play -l ~/ws/bag/acdc_fusion_guidance_noise.bag\n"})}),"\n",(0,i.jsx)(s.p,{children:"This first command opens a preconfigured RViz window showing the visualization of this tasks data. The second commands plays the bag file with the simulated object detections."}),"\n",(0,i.jsx)(s.p,{children:"You should see the following in the RViz window with a similar output:"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"detections_rviz",src:n(6772).A+"",width:"516",height:"584"})}),"\n",(0,i.jsx)(s.h2,{id:"introduction-to-the-eigen-library",children:"Introduction to the Eigen library"}),"\n",(0,i.jsxs)(s.p,{children:["We use the linear algebra library ",(0,i.jsx)(s.a,{href:"https://eigen.tuxfamily.org/dox/GettingStarted.html",children:"Eigen"})," for matrix-vector computations. You can use it for example like this:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-cpp",children:"#include <Eigen/Dense>\n// create a copy of an existing matrix of floating point numbers\nEigen::MatrixXf myNewMatrix1 = myExistingMatrixOfEqualDimensions;\n\n// create a 3x3 matrix of zeros\nEigen::MatrixXf myNewMatrix2 = Eigen::MatrixXf::Zero(3,3); \n\n// edit a specific matrix entry\nmyNewMatrix2(0,0) = 5.678; \n\n// multiply, add, and substract matrices or vectors\n// the dimensions have to fit!\nA = B * C * (d + e - f); \n\n// create a vector of floating point numbers\nEigen::VectorXf myNewVector = someMatrix * someVector;\n\n// transpose or invert matrices\nA = B.transpose() + C.inverse();\n"})}),"\n",(0,i.jsxs)(s.p,{children:['Further commands within the Eigen library can be easily found by googling e.g. "Eigen identity matrix", and using ',(0,i.jsx)("kbd",{children:"Ctrl"}),"+",(0,i.jsx)("kbd",{children:"F"})," on the documentation page."]}),"\n",(0,i.jsx)(s.h2,{id:"introduction-to-the-fusion-code",children:"Introduction to the fusion code"}),"\n",(0,i.jsxs)(s.p,{children:["The overall modular structure of the tracking code template is explained in the ",(0,i.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/tree/main/catkin_workspace/src/workshops/section_3",children:"README.md of the section_3 folder"}),". You may have a look, but you can probably solve the exercise also without this information."]}),"\n",(0,i.jsxs)(s.p,{children:["In contrast, it is important to understand the ",(0,i.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/tree/main/catkin_workspace/src/workshops/section_3/object_fusion",children:"README.md of object_fusion package"}),". It contains more specific information about how the mathematical symbols from the ACDC slides are named or should be named in the code."]}),"\n",(0,i.jsx)(s.p,{children:"Large parts of the object tracking are already implemented, however the code is not functional yet! You can have a look at the current state by starting the fusion node."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"roslaunch object_fusion_wrapper fusion.launch\n"})}),"\n",(0,i.jsx)(s.p,{children:"Don't forget to start RViz and play the bag file beforehand."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"roslaunch acdc_launchpack bag_playback.launch\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"rosbag play -l ~/ws/bag/acdc_fusion_guidance_noise.bag\n"})}),"\n",(0,i.jsx)(s.p,{children:'You sould see that the code outputs "shooting" objects every five seconds, which disappear after one second.'}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"unfinished_fusion_rviz",src:n(4354).A+"",width:"512",height:"580"})}),"\n",(0,i.jsx)(s.h2,{id:"task-1-implement-object-prediction",children:"Task 1: Implement Object Prediction"}),"\n",(0,i.jsxs)(s.p,{children:["Your task is to fill gaps in the C++ code of the ",(0,i.jsx)(s.a,{href:"https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/workshops/section_3/object_fusion/src/modules/predictor/StatePredictor.cpp#L9",children:"object prediction"})," module: ",(0,i.jsx)(s.code,{children:"workshops/section_3/object_fusion/src/modules/predictor/StatePredictor.cpp"})]}),"\n",(0,i.jsx)(s.h4,{id:"updating-ikaobjects-in-place",children:'Updating IkaObjects "in place"'}),"\n",(0,i.jsxs)(s.p,{children:["For the prediction and measurement update code, you need to ",(0,i.jsx)(s.em,{children:"overwrite"})," the global object list ",(0,i.jsx)(s.code,{children:"data_->object_list_fused.objects"})," instead of using ",(0,i.jsx)(s.code,{children:"return"})," statements. Note: when you use the utility functions like ",(0,i.jsx)(s.code,{children:"IkaUtilities::getEigenStateVec(myIkaObject)"}),", they will return an ",(0,i.jsx)(s.code,{children:"Eigen"})," vector or matrix that points to the ",(0,i.jsx)(s.em,{children:"original"})," memory, so by modifying this Eigen data structure, you will automatically overwrite the corresponding ",(0,i.jsx)(s.code,{children:"myIkaObject"}),"."]}),"\n",(0,i.jsx)(s.h4,{id:"prediction-code",children:"Prediction code"}),"\n",(0,i.jsx)(s.p,{children:"Predict the latest global objects to the time stamp of the measured objects. In detail:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Construct the constant velocity motion model matrix ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{mathvariant:"bold",children:"F"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.mi,{mathvariant:"bold",children:"F"}),(0,i.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"c"}),(0,i.jsx)(s.mi,{children:"o"}),(0,i.jsx)(s.mi,{children:"n"}),(0,i.jsx)(s.mi,{children:"s"}),(0,i.jsx)(s.mi,{children:"t"})]}),(0,i.jsx)(s.mo,{children:"+"}),(0,i.jsx)(s.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(s.mi,{children:"t"}),(0,i.jsx)(s.mtext,{children:"\xa0"}),(0,i.jsx)(s.mi,{mathvariant:"bold",children:"F"}),(0,i.jsx)(s.mi,{mathvariant:"normal",children:"_"}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"t"}),(0,i.jsx)(s.mi,{children:"i"}),(0,i.jsx)(s.mi,{children:"m"}),(0,i.jsx)(s.mi,{children:"e"}),(0,i.jsx)(s.mi,{children:"v"}),(0,i.jsx)(s.mi,{children:"a"}),(0,i.jsx)(s.mi,{children:"r"})]})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\mathbf{F} = \\mathbf{F}\\_{const} + \\Delta t\\ \\mathbf{F}\\_{timevar}"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6861em"}}),(0,i.jsx)(s.span,{className:"mord mathbf",children:"F"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.9961em",verticalAlign:"-0.31em"}}),(0,i.jsx)(s.span,{className:"mord mathbf",children:"F"}),(0,i.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",children:"co"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"n"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"t"})]}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"+"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.9961em",verticalAlign:"-0.31em"}}),(0,i.jsx)(s.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(s.span,{className:"mspace",children:"\xa0"}),(0,i.jsx)(s.span,{className:"mord mathbf",children:"F"}),(0,i.jsx)(s.span,{className:"mord",style:{marginRight:"0.02778em"},children:"_"}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"im"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"e"}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"a"}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"})]})]})]})]})," as shown in the slides.","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Its constant entries are already given in ",(0,i.jsx)(s.code,{children:"data_->F_const_"})]}),"\n",(0,i.jsxs)(s.li,{children:["Its time variant entries are already given in ",(0,i.jsx)(s.code,{children:"data_->F_timevar_"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(s.mi,{children:"t"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\Delta t"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"t"})]})})]})," is given in ",(0,i.jsx)(s.code,{children:"data_->prediction_gap_in_seconds"})]}),"\n",(0,i.jsxs)(s.li,{children:["You can check these matrices in the file ",(0,i.jsx)(s.code,{children:"section_3/object_fusion_wrapper/param/kalman_filter.yaml"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Construct the motion noise matrix ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsx)(s.mrow,{children:(0,i.jsx)(s.mi,{mathvariant:"bold",children:"Q"})}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\mathbf{Q}"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8805em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(s.span,{className:"mord mathbf",children:"Q"})]})})]}),".","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["The longer the predicted ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(s.mi,{children:"t"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\Delta t"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"t"})]})})]}),", the more noise we expect --\x3e ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{mathvariant:"bold",children:"Q"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.mi,{mathvariant:"normal",children:"\u0394"}),(0,i.jsx)(s.mi,{children:"t"}),(0,i.jsx)(s.mtext,{children:"\u2009"}),(0,i.jsxs)(s.msub,{children:[(0,i.jsx)(s.mi,{mathvariant:"bold",children:"Q"}),(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"t"}),(0,i.jsx)(s.mi,{children:"i"}),(0,i.jsx)(s.mi,{children:"m"}),(0,i.jsx)(s.mi,{children:"e"}),(0,i.jsx)(s.mi,{children:"v"}),(0,i.jsx)(s.mi,{children:"a"}),(0,i.jsx)(s.mi,{children:"r"})]})]})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\mathbf{Q} = \\Delta t\\, \\mathbf{Q}_{timevar}"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8805em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(s.span,{className:"mord mathbf",children:"Q"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8805em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(s.span,{className:"mord",children:"\u0394"}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord mathbf",children:"Q"}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(s.span,{className:"mord mtight",children:[(0,i.jsx)(s.span,{className:"mord mathnormal mtight",children:"t"}),(0,i.jsx)(s.span,{className:"mord mathnormal mtight",children:"im"}),(0,i.jsx)(s.span,{className:"mord mathnormal mtight",children:"e"}),(0,i.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"v"}),(0,i.jsx)(s.span,{className:"mord mathnormal mtight",children:"a"}),(0,i.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"})]})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]})]})]})]})]}),"\n",(0,i.jsxs)(s.li,{children:["You can use ",(0,i.jsx)(s.code,{children:"data_->Q_timevar_"})]}),"\n",(0,i.jsxs)(s.li,{children:["Check out ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsx)(s.mrow,{children:(0,i.jsx)(s.mi,{mathvariant:"bold",children:"Q"})}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\mathbf{Q}"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8805em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(s.span,{className:"mord mathbf",children:"Q"})]})})]})," in the file ",(0,i.jsx)(s.code,{children:"section_3/object_fusion_wrapper/param/kalman_filter.yaml"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Perform the Kalman filter prediction step for each global object.","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Loop over ",(0,i.jsx)(s.code,{children:"data_->object_list_fused.objects"}),", which is a ",(0,i.jsx)(s.code,{children:"std::vector"})," of global ",(0,i.jsx)(s.code,{children:"IkaObject.msg"})," objects"]}),"\n",(0,i.jsxs)(s.li,{children:["Use the global object's state vector ",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsx)(s.mrow,{children:(0,i.jsxs)(s.msub,{children:[(0,i.jsxs)(s.mover,{accent:"true",children:[(0,i.jsx)(s.mi,{children:"x"}),(0,i.jsx)(s.mo,{children:"^"})]}),(0,i.jsx)(s.mi,{children:"G"})]})}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\hat{x}_G"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.8444em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(s.span,{className:"mord",children:[(0,i.jsx)(s.span,{className:"mord accent",children:(0,i.jsx)(s.span,{className:"vlist-t",children:(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsxs)(s.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,i.jsxs)(s.span,{style:{top:"-3em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"x"})]}),(0,i.jsxs)(s.span,{style:{top:"-3em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(s.span,{className:"accent-body",style:{left:"-0.2222em"},children:(0,i.jsx)(s.span,{className:"mord",children:"^"})})]})]})})})}),(0,i.jsx)(s.span,{className:"msupsub",children:(0,i.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(s.span,{className:"vlist-r",children:[(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(s.span,{className:"mord mathnormal mtight",children:"G"})})]})}),(0,i.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(s.span,{className:"vlist-r",children:(0,i.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(s.span,{})})})]})})]})]})})]})," in the code as an ",(0,i.jsx)(s.code,{children:"Eigen::VectorXf"})," called ",(0,i.jsx)(s.code,{children:"x_hat_G"})," with ",(0,i.jsx)(s.code,{children:"auto x_hat_G = IkaUtilities::getEigenStateVec(&globalObject);"})]}),"\n",(0,i.jsxs)(s.li,{children:["Use the global object's error covariance as an Eigen matrix in the code: ",(0,i.jsx)(s.code,{children:"globalObject.P()"})]}),"\n",(0,i.jsx)(s.li,{children:"Compute the prediction formulas inside the loop"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["Update the ROS time stamps of the global objects: The new global time stamp is the measured time stamp. Overwrite both the global object list time stamp and the individual global objects' time stamps.","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["For object lists, you can use ",(0,i.jsx)(s.code,{children:"data_->object_list_fused.header.stamp"})," and ",(0,i.jsx)(s.code,{children:"data_->object_list_measured.header.stamp"})]}),"\n",(0,i.jsxs)(s.li,{children:["For objects, you can use ",(0,i.jsx)(s.code,{children:"globalObject.header.stamp"})," or ",(0,i.jsx)(s.code,{children:"measuredObject.header.stamp"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["After successfully implementing the prediction code you should see the following output. Don't forget to rebuild the workspace with ",(0,i.jsx)(s.code,{children:"catkin build"})," beforehand! The fused objects are now predicted but not updated yet. You can see that the prediction derives from the reality as the fused objects slowly move away from the detected objects."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"task_1_fusion_rviz",src:n(7822).A+"",width:"514",height:"522"})}),"\n",(0,i.jsx)(s.h2,{id:"advanced-introspection-in-rviz",children:"Advanced: Introspection in RViz"}),"\n",(0,i.jsx)(s.p,{children:"You can see object properties in RViz like this:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Click into the RViz window to focus it."}),"\n",(0,i.jsxs)(s.li,{children:["Hit ",(0,i.jsx)("kbd",{children:"S"}),", and your cursor turns yellow for selection."]}),"\n",(0,i.jsx)(s.li,{children:"Select the objects you want to analyze (click or draw rectangle around)."}),"\n",(0,i.jsx)(s.li,{children:"Open the selection panel on the right to see live updates of the object properties."}),"\n",(0,i.jsxs)(s.li,{children:["To leave this selection mode:","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Click into an empty location to unselect all objects."}),"\n",(0,i.jsxs)(s.li,{children:["Hit ",(0,i.jsx)("kbd",{children:"S"})," again."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{src:n(2854).A+"",width:"842",height:"467"})})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},6772:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/detections_rviz-09306bbe5aae7514290144b3a1241094.gif"},7822:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/task_1_fusion_rviz-9ff2a9489964acf03014480d31f253d8.gif"},4354:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/unfinished_fusion_rviz-eb70589d28d1a767d6b9c10eded2916f.gif"},2854:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/selection_screenshot-f93d0c66b9ed6c4309954cc36cb45c40.png"},8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>r});var a=n(6540);const i={},t=a.createContext(i);function c(e){const s=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),a.createElement(t.Provider,{value:s},e.children)}}}]);