<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-task/sensor_data_processing/Object-Detection" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Object Detection | Automated and Connected Driving</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cagricatik.github.io/Autonomous-Connected-Driving/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://cagricatik.github.io/Autonomous-Connected-Driving/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://cagricatik.github.io/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Object-Detection"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Object Detection | Automated and Connected Driving"><meta data-rh="true" name="description" content="ROS1"><meta data-rh="true" property="og:description" content="ROS1"><link data-rh="true" rel="icon" href="/Autonomous-Connected-Driving/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cagricatik.github.io/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Object-Detection"><link data-rh="true" rel="alternate" href="https://cagricatik.github.io/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Object-Detection" hreflang="en"><link data-rh="true" rel="alternate" href="https://cagricatik.github.io/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Object-Detection" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Autonomous-Connected-Driving/blog/rss.xml" title="Automated and Connected Driving RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Autonomous-Connected-Driving/blog/atom.xml" title="Automated and Connected Driving Atom Feed"><link rel="stylesheet" href="/Autonomous-Connected-Driving/assets/css/styles.ce2d5abf.css">
<script src="/Autonomous-Connected-Driving/assets/js/runtime~main.44092a58.js" defer="defer"></script>
<script src="/Autonomous-Connected-Driving/assets/js/main.b69c5ba1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Autonomous-Connected-Driving/"><div class="navbar__logo"><img src="/Autonomous-Connected-Driving/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Autonomous-Connected-Driving/img/logo.png" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/theory/introduction-tools/getting_started">Introduction &amp; Tools</a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/theory/sensor-data-processing/getting_started">Sensor Data Processing</a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/theory/object-fusion-tracking/getting_started">Object Fusion and Tracking</a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/theory/vehicle-guidance/getting_started">Vehicle Guidance</a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/theory/connected-driving/getting_started">Connected Driving</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Autonomous-Connected-Driving/docs/task/getting_started">Tasks</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/cpp/getting_started">C++</a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/python/getting_started">Python</a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/ros/getting_started">ROS</a><a class="navbar__item navbar__link" href="/Autonomous-Connected-Driving/docs/ros2/getting_started">ROS2</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Autonomous-Connected-Driving/docs/task/getting_started">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Autonomous-Connected-Driving/docs/category/introduction--tools">Introduction &amp; Tools</a><button aria-label="Expand sidebar category &#x27;Introduction &amp; Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/Autonomous-Connected-Driving/docs/category/sensor-data-processing">Sensor Data Processing</a><button aria-label="Collapse sidebar category &#x27;Sensor Data Processing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Camera-based-Semantic-Grid-Mapping">Camera-based Semantic Grid Mapping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Deep-OGM">Deep Learning-based Point Cloud Occupancy Grid Mapping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Geometric-OGM">Geometric Point Cloud Occupancy Grid Mapping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Localization">Localization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Object-Detection">Object Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Semantic-Image-Segmentation">Perform Deep Learning based semantic image segmentation applied on camera images</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Semantic-Point-Cloud-Segmentation">Perform Deep Learning based Semantic Point Cloud Segmentation</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Autonomous-Connected-Driving/docs/category/object-fusion-tracking">Object Fusion Tracking</a><button aria-label="Expand sidebar category &#x27;Object Fusion Tracking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Autonomous-Connected-Driving/docs/category/vehicle-guidance">Vehicle Guidance</a><button aria-label="Expand sidebar category &#x27;Vehicle Guidance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Autonomous-Connected-Driving/docs/category/connected-driving">Connected Driving</a><button aria-label="Expand sidebar category &#x27;Connected Driving&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Autonomous-Connected-Driving/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Autonomous-Connected-Driving/docs/category/sensor-data-processing"><span itemprop="name">Sensor Data Processing</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Object Detection</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Object Detection</h1></header>
<p><img decoding="async" loading="lazy" src="https://img.shields.io/badge/ROS1-blue" alt="ROS1" class="img_ev3q"></p>
<img src="../images/section_2/object_detection/header_object_detection.png" alt="Description of image">
<p>In this assignment, we will focus on <strong>3D object detection</strong> for raw LiDAR within ROS. In particular, we consider a recording from our test vehicle which is equipped with a <a href="https://icave2.cse.buffalo.edu/resources/sensor-modeling/VLP32CManual.pdf" target="_blank" rel="noopener noreferrer">Velodyne VLP-32C</a> and apply a state-of-the art 3D object detection model to predict bounding boxes.</p>
<p>In this exercise you will learn</p>
<ul>
<li>how ROS <strong>object definitions</strong> are defined</li>
<li>to visualize <strong>LiDAR point clouds</strong> within <strong>RViz</strong></li>
<li>how to launch a <strong>ROS node</strong> that applies a detection algorithm on the raw sensor data</li>
<li>to use <strong>RVIZ</strong> to visualize <strong>detected objects</strong></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="definitions">Definitions<a href="#definitions" class="hash-link" aria-label="Direct link to Definitions" title="Direct link to Definitions">​</a></h2>
<p>The ika definitions for the ROS messages and other internal definitions are defined in the package <a href="https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/dependencies/definitions" target="_blank" rel="noopener noreferrer"><em>definitions</em></a>. The ROS message files are located in the subdirectory <a href="https://github.com/ika-rwth-aachen/acdc/tree/main/catkin_workspace/src/dependencies/definitions/msg" target="_blank" rel="noopener noreferrer">definitions/msg</a> and all other internal definitions can be found in <code>~/ws/catkin_workspace/src/dependencies/definitions/include/definitions/utility</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ika-ros-object-definition">ika ROS Object Definition<a href="#ika-ros-object-definition" class="hash-link" aria-label="Direct link to ika ROS Object Definition" title="Direct link to ika ROS Object Definition">​</a></h3>
<p>The files <a href="https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/dependencies/definitions/msg/IkaObject.msg" target="_blank" rel="noopener noreferrer">IkaObject.msg</a> and <a href="https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/dependencies/definitions/include/definitions/utility/object_definitions.h" target="_blank" rel="noopener noreferrer">object_definitions.h</a> define the properties of an <strong>3D object</strong>. By the term <em>object</em>, we refer to a surround traffic participant which can be assigned to a class (e.g. car, pedestrian, truck) and has an estimated state (e.g. position, velocity, orientation). The ika object definitions distinguish between several classes as shown in the following snipped (excerpt from <a href="https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/dependencies/definitions/include/definitions/utility/object_definitions.h#L96" target="_blank" rel="noopener noreferrer">object_definitions.h</a>
):</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">enum ika_object_types {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UNCLASSIFIED = 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  PEDESTRIAN = 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BICYCLE = 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  MOTORBIKE = 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  CAR = 4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TRUCK = 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VAN = 6,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BUS = 7,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ANIMAL = 8,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ROAD_OBSTACLE = 9,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TRAILER = 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  TYPES_COUNT = 11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For simplicity, we will focus in this assignment on the classes <code>CAR</code>, <code>PEDESTRIAN</code>, <code>TRUCK</code> and <code>BIKE</code>. Note that the <a href="https://en.cppreference.com/w/cpp/language/enum" target="_blank" rel="noopener noreferrer">enumeration</a> above assigns each type to an unique ID. For example, type <code>CAR</code> has ID 4. This association can then be accessed in the code with <code>definitions::ika_object_types::CAR</code>.</p>
<p>The following code snippet presents an excerpt from the file <a href="https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/dependencies/definitions/msg/IkaObject.msg" target="_blank" rel="noopener noreferrer">IkaObject.msg</a>. As shown below, each object has a <strong>state vector</strong> which holds current values of the object, such as the <strong>position</strong>, <strong>velocity</strong>, <strong>acceleration</strong> and the <strong>3D bounding box</strong>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">float32[] fMean               # Statevector, containing attributes depend on chosen motion model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">float32[] fCovariance         # Covariance-Matrix, containing attributes depend on chosen motion model</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As each quantity might be estimated by the AV&#x27;s sensors and its perception algorithms, which are not perfect, we need to consider uncertainties as well. The <strong>state covariance vector</strong> stores such uncertainties, which are necessary in later processing steps such as the object fusion.</p>
<p>In this assignment we will focus purely on 3D object detection. That means, we will just consider the state vector <code>fMean</code>, which basically describe an object&#x27;s bounding box.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ika-ros-object-lists-definition">ika ROS Object Lists Definition<a href="#ika-ros-object-lists-definition" class="hash-link" aria-label="Direct link to ika ROS Object Lists Definition" title="Direct link to ika ROS Object Lists Definition">​</a></h3>
<p>Sending many single object messages from various sources over the ROS network might be very tedious to handle and organize. Further, sensor&#x27;s have often a fixed sample rate in which they detect and send several objects. Hence, so called <em>object lists</em> are used to handle and send several object messages at once. The <a href="https://github.com/ika-rwth-aachen/acdc/blob/main/catkin_workspace/src/dependencies/definitions/msg/IkaObjectList.msg" target="_blank" rel="noopener noreferrer"><code>IkaObjectList.msg</code></a> defines such a list. The implementation for the <code>IkaObjectList</code> is shown below</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">std_msgs/Header header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># List meta information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uint8 IdSource    #see definitions/utility/object_definitions.h for enum of sensors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Actually objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IkaObject[] objects</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you can see, the message <code>IkaObjectList</code> has a field <code>objects</code> which is a list (with undefined length) and contains elements of the type <code>IkaObject</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="measurement-data">Measurement Data<a href="#measurement-data" class="hash-link" aria-label="Direct link to Measurement Data" title="Direct link to Measurement Data">​</a></h2>
<p>We provide real sensor data from our institute&#x27;s test vehicle which is equipped with a Velodyne VLP-32C. This laser scanner has 32 layers and scans its environment with 10 Hz. The recordings were captured at Campus Melaten in Aachen, Germandy and can be downloaded as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget -O lidar_campus_melaten.bag https://rwth-aachen.sciebo.de/s/udlMYloXpCdVtyp/download</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Alternatively, you can download the bag file for this assignment here <a href="https://rwth-aachen.sciebo.de/s/udlMYloXpCdVtyp" target="_blank" rel="noopener noreferrer"><strong>Link</strong></a> (approx. 1.5 GB).</p>
<p>Save the file to the local directory <code>${REPOSITORY}/bag</code> on you host which is mounted to <code>~/bag</code> in the docker container. Now, we want to work with the <code>rosbag</code> commands inside the container</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rosbag-inspection">Rosbag Inspection<a href="#rosbag-inspection" class="hash-link" aria-label="Direct link to Rosbag Inspection" title="Direct link to Rosbag Inspection">​</a></h3>
<p>Inspect the bag file with the command <code>rosbag info</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rosuser@:/home/rosuser/bag# rosbag info lidar_campus_melaten.bag </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path:        lidar_campus_melaten.bag </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version:     2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">duration:    1:59s (119s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start:       Feb 05 2020 15:25:31.41 (1580916331.41)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end:         Feb 05 2020 15:27:31.37 (1580916451.37)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">size:        1.5 GB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">messages:    1200</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">compression: none [1199/1199 chunks]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">types:       sensor_msgs/PointCloud2 [1158d486dd51d683ce2f1be655c3c181]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             tf2_msgs/TFMessage      [94810edda583a504dfda3829e70d7eec]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">topics:      /points2     1199 msgs    : sensor_msgs/PointCloud2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             /tf_static      1 msg     : tf2_msgs/TFMessage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you can see the bag file contains the topic <code>/points2</code> which contains messages of type <code>sensor_msgs/PointCloud2</code>. In contrast to the ika ROS message definition, this message type is a standard message which was defined by the ROS community. The message definition can be found <a href="http://docs.ros.org/noetic/api/sensor_msgs/html/msg/PointCloud2.html" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rosbag-visualization">Rosbag Visualization<a href="#rosbag-visualization" class="hash-link" aria-label="Direct link to Rosbag Visualization" title="Direct link to Rosbag Visualization">​</a></h3>
<p>Now, we want to visualize the point clouds using RVIZ.</p>
<p>Instead of starting a <code>roscore</code>, <code>rviz</code> and <code>rosbag play</code>, we suggest to use a launch file to execute all three commands at once. We prepared such a launch file for you here <code>workshops/section_2/lidar_detection/launch/start_rosbag_play_rviz.launch</code>:</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">launch</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Rosbag --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">param</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">use_sim_time</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">true</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">node</span><span class="token tag" style="color:#00009f"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">pkg</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">rosbag</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">play</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">args</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">--clock -l -r 0.5 -d 1 /home/rosuser/bag/lidar_campus_melaten.bag</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">player</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">output</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">screen</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">node</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- RViz --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">node</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">rviz</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">rviz</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">pkg</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">rviz</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag attr-name" style="color:#00a4db">args</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">-d $(find lidar_detection)/rviz/point_cloud.rviz</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">node</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">launch</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you can see, <code>rosbag play</code> and <code>rviz</code> are evoked. The launch file basically bundles all necessary commands to run the nodes with their parameters and executes them simultaneously. Furthermore, <code>roscore</code> is called implicitly and it is not necessary to manually execute it.</p>
<p>Since the launch file is in the package <code>lidar_detection</code>, you can simply start it with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">roslaunch lidar detection start_rosbag_play_rviz.launch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The RViz window should pop up and you should see something like this</p>
<img src="../images/section_2/object_detection/rviz.png" alt="Description of image">
<p>For a better visualization you may alter the display settings. Have a look on tab <code>PointCloud2</code>. Here you could increase <code>Size</code> to different values. Feel free to play with the settings such as <code>Style</code>, <code>Decay Time</code> or <code>Color Transformer</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="recap-navigation-in-rviz">Recap: Navigation in RVIZ<a href="#recap-navigation-in-rviz" class="hash-link" aria-label="Direct link to Recap: Navigation in RVIZ" title="Direct link to Recap: Navigation in RVIZ">​</a></h4>
<ul>
<li>Left mouse button: Click and drag to rotate around the Z axis</li>
<li>Middle mouse button: Click and drag to move the camera along the XY plane</li>
<li>Right mouse button: Click and drag to zoom the image</li>
<li>Scrollwheel: Zoom the image</li>
</ul>
<p><strong>Congratulations!</strong> We can terminate the previous launch file and focus on the actual lidar detection alorithms in the following.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lidar-detection">Lidar Detection<a href="#lidar-detection" class="hash-link" aria-label="Direct link to Lidar Detection" title="Direct link to Lidar Detection">​</a></h2>
<p>We already provide a ROS package <code>lidar_detection</code> for the detection of 3D objects, where the actual inference of the deep learning model is performed first, before generating the bounding boxes and object lists in a second step. The code is located in <code>~/ws/catkin_workspace/src/workshops/section_2/lidar_detection</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">section_2/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── lidar_detection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── CMakeLists.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── include</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── definitions.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── detector.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── lidar_detection.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── list_creator.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── pillar_utils.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── launch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── static_params.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── start_all.launch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── start_lidar_detection.launch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── start_rosbag_play_rviz.launch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ├── lidar_detection.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── FrozenGraphs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │        └──lidar_detection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            └──lidar_detection.pb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── nodelet_plugins.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── package.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── rviz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── point_cloud.rviz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── definitions.cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── detector.cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── lidar_detection.cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ├── list_creator.cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── pillar_utils.cpp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Don&#x27;t be overwhelmed by the amount of code and all the details of this implementation. We do not require you to understand every line of code. As previously mentioned, the 3D Object Detection algorithm is called PointPillars which is based on a Deep Neural Network. We do not explain more details of this model here but we refer interested readers to <a href="https://arxiv.org/abs/1812.05784" target="_blank" rel="noopener noreferrer">https://arxiv.org/abs/1812.05784</a>.</p>
<p>Now, it&#x27;s time to launch the <code>lidar_detection</code> node. Navigate to <code>~/ws/catkin_workspace</code> and build/source your workspace again to ensure that everything is well prepared.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">catkin build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">source devel/setup.bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After this you can launch the <code>lidar_detection</code> node as well as the previous point cloud visualization. We provide a combined launch file which launches both tasks together.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">roslaunch lidar_detection start_all.launch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Note</strong> that the bag file is being replayed with a rate of <code>0.1</code> as the inference of the neural net for object detection is quite time demanding without using a GPU. Depending on the performance of you computer you might increase that factor.</p>
<p>Now, the <code>lidar_detection</code> node should be running and the RVIZ window should have popped up. Let&#x27;s configure RVIZ to visualize the <code>ikaObjectLists</code> messages.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="visualize-object-list">Visualize Object List<a href="#visualize-object-list" class="hash-link" aria-label="Direct link to Visualize Object List" title="Direct link to Visualize Object List">​</a></h3>
<p>Click on <em>ADD</em> --&gt; <em>By Topic</em> --&gt; <em>Select <code>/lidar_detection/object_list/IkaObjectList</code></em> --&gt; <em>Ok</em></p>
<img src="../images/section_2/object_detection/rviz_select.png" alt="Description of image">
<p>Now, the detections should be visible and you should see something similar to this.</p>
<img src="../images/section_2/object_detection/task.png" alt="Description of image">
<p>Unfortunately, there&#x27;s something wrong. The bounding boxes do not fit the objects very well and all objects are classified as <code>UNKNOWN</code>, although we can clearly see vehicles and pedestrians in the point clouds. Let&#x27;s fix this issue in the two upcoming tasks.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Direct link to Task 1" title="Direct link to Task 1">​</a></h2>
<p>As you have seen in the previous task, the output of the object detection has some flaws. We forgot to set the correct size of the object boxes and the heading angle. In this task you will fix that problem and assign the correct values to the <code>IkaObject</code> message.</p>
<p>Open the file <code>list_creator.cpp</code> and navigate to the following code snipped.</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// set object position</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object.fMean[(int)definitions::ca_model::posX] = bounding_box.center(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object.fMean[(int)definitions::ca_model::posY] = bounding_box.center(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ...  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// START TASK 1 CODE  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// set object dimensions and fHeading</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object.fMean[(int)definitions::ca_model::length] = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object.fMean[(int)definitions::ca_model::width] = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object.fMean[(int)definitions::ca_model::height] = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// set yaw angle</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object.fMean[(int)definitions::ca_model::heading] = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// END TASK 1 CODE </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can see that two different variables are used:</p>
<ul>
<li><code>object</code>: Instance of <a href="#ObjectStateDefinition">IkaObject.msg</a></li>
<li><code>bounding_box</code>: Instance of struct <code>BoundingBoxCenter</code>. The definition of this struct is given in file <code>definitions.h</code>:</li>
</ul>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">struct BoundingBoxCenter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Eigen::Vector2d center;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  float z;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  float length;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  float width;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  float height;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  float yaw;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  float score;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  int class_idx;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std::string class_name;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You may have noticed, that position of the object is correctly assigned, but we did not assign the dimensions and heading angle of the object correctly. However, the detection algorithm stores its estimates in <code>bounding_box</code>.</p>
<p>Now, fix the problem and assign the quantities of <code>bounding_box</code> to <code>object</code>. Modify the code just in between the brackets to avoid any problems.</p>
<p><strong>Note:</strong> After your implementation, you have to rebuild the <code>lidar_detection</code> package, before starting everything again:</p>
<ol>
<li>Compile the code: <code>catkin build</code></li>
<li>Launch the node: <code>roslaunch lidar_detection start_all.launch</code></li>
<li>Reconfigure RVIZ to display the <code>ikaObjectList</code></li>
</ol>
<p>Note: You may also store the current RVIZ configuration with <code>File</code> -&gt; <code>Save Config</code> and load the config via the launch file or with <code>Open Config</code> in order to avoid the third step.</p>
<p>In case you correctly implemented the code block, you can see that the detected objects are associated with the estimated bounding box dimensions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Direct link to Task 2" title="Direct link to Task 2">​</a></h2>
<p>In the previous task, you corrected the dimensions and orientation of the bounding box. But the object boxes in RVIZ still do not show a correct classification of the detected objects. All objects are still associated with class <code>UNKNOWN</code>. Now, lets tackle this problem:</p>
<p>Inspect the file <code>detector.cpp</code> and search for the <code>TASK 2 CODE</code> brackets. This snippets calculates the <code>class_idx</code> of a bounding box, which should represent the index of the most probable class value, based on all predicted <code>class_scores</code>.</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// START TASK 2 CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int class_idx = -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// END TASK 2 CODE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Your task is now to compute the correct value for <code>class_idx</code>.</p>
<p>Hints:</p>
<ul>
<li>You can use <code>std::max_element</code> to find the position of the maximum of an array.</li>
<li>In this example the position of the maximum can be used as the new <code>class_idx</code>.</li>
</ul>
<p>After your implementation, you have to rebuild the <code>lidar_detection</code> package, before starting it again:</p>
<ol>
<li>Compile the code: <code>catkin build</code></li>
<li>Launch the node: <code>roslaunch lidar_detection start_all.launch</code></li>
<li>Reconfigure RVIZ to display the <code>ikaObjectList</code></li>
</ol>
<p>Note: You may also store the current RVIZ configuration with <code>File</code> -&gt; <code>Save Config</code> and load the config via the launch file or with <code>Open Config</code> in order to avoid the third step.</p>
<p>In case you correctly implemented the function, you can see that the detected objects are associated with the estimated classes.</p>
<img src="../images/section_2/object_detection/result.png" alt="Description of image">
<p><strong>Note</strong>: You will notice that due to the correct class assignment, much less false positive detections occur. This is because the correct score threshold can be applied which improves the overall performance a lot!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="wrap-up">Wrap-up<a href="#wrap-up" class="hash-link" aria-label="Direct link to Wrap-up" title="Direct link to Wrap-up">​</a></h2>
<ul>
<li>You learned the basics about 3D object detection</li>
<li>You learned about the <strong>IkaObject</strong> and <strong>IkaObjectLists</strong> message definitions</li>
<li>You learned how to launch a <strong>ROS node</strong></li>
<li>You learned to use <strong>RVIZ</strong> to visualize <strong>LiDAR point clouds</strong></li>
<li>You learned to use <strong>RVIZ</strong> to visualize <strong>detected objects</strong></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/task/02_sensor_data_processing/05_Object-Detection.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Localization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Localization</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Autonomous-Connected-Driving/docs/task/sensor_data_processing/Semantic-Image-Segmentation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Perform Deep Learning based semantic image segmentation applied on camera images</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#definitions" class="table-of-contents__link toc-highlight">Definitions</a><ul><li><a href="#ika-ros-object-definition" class="table-of-contents__link toc-highlight">ika ROS Object Definition</a></li><li><a href="#ika-ros-object-lists-definition" class="table-of-contents__link toc-highlight">ika ROS Object Lists Definition</a></li></ul></li><li><a href="#measurement-data" class="table-of-contents__link toc-highlight">Measurement Data</a><ul><li><a href="#rosbag-inspection" class="table-of-contents__link toc-highlight">Rosbag Inspection</a></li><li><a href="#rosbag-visualization" class="table-of-contents__link toc-highlight">Rosbag Visualization</a></li></ul></li><li><a href="#lidar-detection" class="table-of-contents__link toc-highlight">Lidar Detection</a><ul><li><a href="#visualize-object-list" class="table-of-contents__link toc-highlight">Visualize Object List</a></li></ul></li><li><a href="#task-1" class="table-of-contents__link toc-highlight">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link toc-highlight">Task 2</a></li><li><a href="#wrap-up" class="table-of-contents__link toc-highlight">Wrap-up</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Coding</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Autonomous-Connected-Driving/docs/cpp/content">C++</a></li><li class="footer__item"><a class="footer__link-item" href="/Autonomous-Connected-Driving/docs/python/content">Python</a></li></ul></div><div class="col footer__col"><div class="footer__title">Robot Operating System</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Autonomous-Connected-Driving/docs/ros/content">ROS</a></li><li class="footer__item"><a class="footer__link-item" href="/Autonomous-Connected-Driving/docs/ros2/content">ROS2</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Autonomous-Connected-Driving/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/CagriCatik/Autonomous-Connected-Driving" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 - Automated and Connected Driving.</div></div></div></footer></div>
</body>
</html>